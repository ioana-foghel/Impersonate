2018-05-14 08:48:20.7718|ERROR|Templates|Error compiling razor template
RazorEngine.Templating.TemplateCompilationException: Unable to compile template. Could not write to output file 'c:\Windows\Temp\ei3tza3i.dll' -- 'The process cannot access the file because it is being used by another process. '

Other compilation errors may have occurred. Check the Errors property for more information.
   at RazorEngine.Compilation.DirectCompilerServiceBase.CompileType(TypeContext context)
   at RazorEngine.Templating.TemplateService.CreateTemplateType(String razorTemplate, Type modelType)
   at RazorEngine.Templating.TemplateService.GetTemplate[T](String razorTemplate, Object model, String cacheName)
   at RazorEngine.Templating.TemplateService.GetTemplate(String razorTemplate, Object model, String cacheName)
   at RazorEngine.Templating.TemplateService.Parse(String razorTemplate, Object model, DynamicViewBag viewBag, String cacheName)
   at RazorEngine.Razor.Parse[T](String razorTemplate, T model, String cacheName)
   at Dynamicweb.Rendering.Template.RenderRazorTemplate()
Error compiling template "Designs/Rapido/UserManagement/Login/RecoveryEmail.cshtml"
Line 0: Could not write to output file 'c:\Windows\Temp\ei3tza3i.dll' -- 'The process cannot access the file because it is being used by another process. '
<hr/>
<div class='template-code'>
<span class='line-number'>  1</span>	@inherits RazorTemplateBase&lt;RazorTemplateModel&lt;Template&gt;&gt;
<span class='line-number'>  2</span>	@using Dynamicweb.Rendering;
<span class='line-number'>  3</span>	
<span class='line-number'>  4</span>	@functions {
<span class='line-number'>  5</span>	    public class Text
<span class='line-number'>  6</span>	    {
<span class='line-number'>  7</span>	        public string content { get; set; }
<span class='line-number'>  8</span>	
<span class='line-number'>  9</span>	        public void Add(string textString)
<span class='line-number'> 10</span>	        {
<span class='line-number'> 11</span>	            content += textString + &quot;&lt;br&gt;&quot;;
<span class='line-number'> 12</span>	        }
<span class='line-number'> 13</span>	    }
<span class='line-number'> 14</span>	
<span class='line-number'> 15</span>	    public class RowSettings
<span class='line-number'> 16</span>	    {
<span class='line-number'> 17</span>	        public string backgroundColor { get; set; }
<span class='line-number'> 18</span>	        public string background { get; set; }
<span class='line-number'> 19</span>	        public string padding { get; set; }
<span class='line-number'> 20</span>	
<span class='line-number'> 21</span>	        //Defaults
<span class='line-number'> 22</span>	        public RowSettings()
<span class='line-number'> 23</span>	        {
<span class='line-number'> 24</span>	            backgroundColor = &quot;#FFFFFF&quot;;
<span class='line-number'> 25</span>	            background = &quot;&quot;;
<span class='line-number'> 26</span>	            padding = &quot;30&quot;;
<span class='line-number'> 27</span>	        }
<span class='line-number'> 28</span>	    }
<span class='line-number'> 29</span>	
<span class='line-number'> 30</span>	    public class Column
<span class='line-number'> 31</span>	    {
<span class='line-number'> 32</span>	        public string image { get; set; }
<span class='line-number'> 33</span>	        public string imageSize { get; set; }
<span class='line-number'> 34</span>	        public string preheader { get; set; }
<span class='line-number'> 35</span>	        public string introheader { get; set; }
<span class='line-number'> 36</span>	        public string header { get; set; }
<span class='line-number'> 37</span>	        public string subheader { get; set; }
<span class='line-number'> 38</span>	        public Text text { get; set; }
<span class='line-number'> 39</span>	        public string textColor { get; set; }
<span class='line-number'> 40</span>	        public string align { get; set; }
<span class='line-number'> 41</span>	        public string link { get; set; }
<span class='line-number'> 42</span>	        public string linkText { get; set; }
<span class='line-number'> 43</span>	        public string buttonColor { get; set; }
<span class='line-number'> 44</span>	        public string width { get; set; }
<span class='line-number'> 45</span>	
<span class='line-number'> 46</span>	        //Defaults
<span class='line-number'> 47</span>	        public Column()
<span class='line-number'> 48</span>	        {
<span class='line-number'> 49</span>	            textColor = &quot;#333&quot;;
<span class='line-number'> 50</span>	            align = &quot;left&quot;;
<span class='line-number'> 51</span>	            buttonColor = &quot;#EC683B&quot;;
<span class='line-number'> 52</span>	
<span class='line-number'> 53</span>	            //Initialize the text object
<span class='line-number'> 54</span>	            this.text = new Text() { content = &quot;&quot; };
<span class='line-number'> 55</span>	        }
<span class='line-number'> 56</span>	    }
<span class='line-number'> 57</span>	}
<span class='line-number'> 58</span>	
<span class='line-number'> 59</span>	&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;
<span class='line-number'> 60</span>	&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;
<span class='line-number'> 61</span>	&lt;head&gt;
<span class='line-number'> 62</span>	    &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;
<span class='line-number'> 63</span>	    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot; /&gt;
<span class='line-number'> 64</span>	    &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge,chrome=1&quot; /&gt;
<span class='line-number'> 65</span>	    &lt;meta name=&quot;format-detection&quot; content=&quot;telephone=no&quot; /&gt; &lt;!-- disable auto telephone linking in iOS --&gt;
<span class='line-number'> 66</span>	    &lt;title&gt;Rapido email&lt;/title&gt;
<span class='line-number'> 67</span>	    &lt;style type=&quot;text/css&quot;&gt;
<span class='line-number'> 68</span>	        /* RESET STYLES */
<span class='line-number'> 69</span>	        html {
<span class='line-number'> 70</span>	            background-color: #d3d3d3;
<span class='line-number'> 71</span>	            margin: 0;
<span class='line-number'> 72</span>	            padding: 0;
<span class='line-number'> 73</span>	        }
<span class='line-number'> 74</span>	
<span class='line-number'> 75</span>	        body, #bodyTable, #bodyCell, #bodyCell {
<span class='line-number'> 76</span>	            height: 100% !important;
<span class='line-number'> 77</span>	            margin: 0;
<span class='line-number'> 78</span>	            padding: 0;
<span class='line-number'> 79</span>	            width: 100% !important;
<span class='line-number'> 80</span>	            font-family: Helvetica, Arial, &quot;Lucida Grande&quot;, sans-serif;
<span class='line-number'> 81</span>	        }
<span class='line-number'> 82</span>	
<span class='line-number'> 83</span>	        table {
<span class='line-number'> 84</span>	            border-collapse: collapse;
<span class='line-number'> 85</span>	        }
<span class='line-number'> 86</span>	
<span class='line-number'> 87</span>	            table[id=bodyTable] {
<span class='line-number'> 88</span>	                width: 100% !important;
<span class='line-number'> 89</span>	                margin: auto;
<span class='line-number'> 90</span>	                max-width: 500px !important;
<span class='line-number'> 91</span>	                color: #7A7A7A;
<span class='line-number'> 92</span>	                font-weight: normal;
<span class='line-number'> 93</span>	            }
<span class='line-number'> 94</span>	
<span class='line-number'> 95</span>	        img, a img {
<span class='line-number'> 96</span>	            border: 0;
<span class='line-number'> 97</span>	            outline: none;
<span class='line-number'> 98</span>	            text-decoration: none;
<span class='line-number'> 99</span>	            height: auto;
<span class='line-number'>100</span>	            line-height: 100%;
<span class='line-number'>101</span>	        }
<span class='line-number'>102</span>	
<span class='line-number'>103</span>	        a {
<span class='line-number'>104</span>	            text-decoration: none !important;
<span class='line-number'>105</span>	            border-bottom: 1px solid;
<span class='line-number'>106</span>	        }
<span class='line-number'>107</span>	
<span class='line-number'>108</span>	        h1, h2, h3, h4, h5, h6 {
<span class='line-number'>109</span>	            color: #5F5F5F;
<span class='line-number'>110</span>	            font-weight: normal;
<span class='line-number'>111</span>	            font-family: Helvetica;
<span class='line-number'>112</span>	            font-size: 20px;
<span class='line-number'>113</span>	            line-height: 125%;
<span class='line-number'>114</span>	            text-align: Left;
<span class='line-number'>115</span>	            letter-spacing: normal;
<span class='line-number'>116</span>	            margin-top: 0;
<span class='line-number'>117</span>	            margin-right: 0;
<span class='line-number'>118</span>	            margin-bottom: 10px;
<span class='line-number'>119</span>	            margin-left: 0;
<span class='line-number'>120</span>	            padding-top: 0;
<span class='line-number'>121</span>	            padding-bottom: 0;
<span class='line-number'>122</span>	            padding-left: 0;
<span class='line-number'>123</span>	            padding-right: 0;
<span class='line-number'>124</span>	        }
<span class='line-number'>125</span>	
<span class='line-number'>126</span>	        /* CLIENT-SPECIFIC STYLES */
<span class='line-number'>127</span>	        .ReadMsgBody {
<span class='line-number'>128</span>	            width: 100%;
<span class='line-number'>129</span>	        }
<span class='line-number'>130</span>	
<span class='line-number'>131</span>	        .ExternalClass {
<span class='line-number'>132</span>	            width: 100%;
<span class='line-number'>133</span>	        }
<span class='line-number'>134</span>	            /* Force Hotmail/Outlook.com to display emails at full width. */
<span class='line-number'>135</span>	            .ExternalClass, .ExternalClass p, .ExternalClass span, .ExternalClass font, .ExternalClass td, .ExternalClass div {
<span class='line-number'>136</span>	                line-height: 100%;
<span class='line-number'>137</span>	            }
<span class='line-number'>138</span>	        /* Force Hotmail/Outlook.com to display line heights normally. */
<span class='line-number'>139</span>	        table, td {
<span class='line-number'>140</span>	            mso-table-lspace: 0pt;
<span class='line-number'>141</span>	            mso-table-rspace: 0pt;
<span class='line-number'>142</span>	        }
<span class='line-number'>143</span>	        /* Remove spacing between tables in Outlook 2007 and up. */
<span class='line-number'>144</span>	        #outlook a {
<span class='line-number'>145</span>	            padding: 0;
<span class='line-number'>146</span>	        }
<span class='line-number'>147</span>	        /* Force Outlook 2007 and up to provide a &quot;view in browser&quot; message. */
<span class='line-number'>148</span>	        img {
<span class='line-number'>149</span>	            -ms-interpolation-mode: bicubic;
<span class='line-number'>150</span>	            display: block;
<span class='line-number'>151</span>	            outline: none;
<span class='line-number'>152</span>	            text-decoration: none;
<span class='line-number'>153</span>	        }
<span class='line-number'>154</span>	        /* Force IE to smoothly render resized images. */
<span class='line-number'>155</span>	        body, table, td, p, a, li, blockquote {
<span class='line-number'>156</span>	            -ms-text-size-adjust: 100%;
<span class='line-number'>157</span>	            -webkit-text-size-adjust: 100%;
<span class='line-number'>158</span>	            font-weight: normal !important;
<span class='line-number'>159</span>	        }
<span class='line-number'>160</span>	        /* Prevent Windows- and Webkit-based mobile platforms from changing declared text sizes. */
<span class='line-number'>161</span>	        .ExternalClass td[class=&quot;ecxflexibleContainerBox&quot;] h3 {
<span class='line-number'>162</span>	            padding-top: 10px !important;
<span class='line-number'>163</span>	        }
<span class='line-number'>164</span>	        /* Force hotmail to push 2-grid sub headers down */
<span class='line-number'>165</span>	
<span class='line-number'>166</span>	        /* /\/\/\/\/\/\/\/\/ TEMPLATE STYLES /\/\/\/\/\/\/\/\/ */
<span class='line-number'>167</span>	
<span class='line-number'>168</span>	        /* ========== Page Styles ========== */
<span class='line-number'>169</span>	        h1 {
<span class='line-number'>170</span>	            display: block;
<span class='line-number'>171</span>	            font-size: 26px;
<span class='line-number'>172</span>	            font-style: normal;
<span class='line-number'>173</span>	            font-weight: normal;
<span class='line-number'>174</span>	            line-height: 100%;
<span class='line-number'>175</span>	        }
<span class='line-number'>176</span>	
<span class='line-number'>177</span>	        h2 {
<span class='line-number'>178</span>	            display: block;
<span class='line-number'>179</span>	            font-size: 20px;
<span class='line-number'>180</span>	            font-style: normal;
<span class='line-number'>181</span>	            font-weight: normal;
<span class='line-number'>182</span>	            line-height: 120%;
<span class='line-number'>183</span>	        }
<span class='line-number'>184</span>	
<span class='line-number'>185</span>	        h3 {
<span class='line-number'>186</span>	            display: block;
<span class='line-number'>187</span>	            font-size: 17px;
<span class='line-number'>188</span>	            font-style: normal;
<span class='line-number'>189</span>	            font-weight: normal;
<span class='line-number'>190</span>	            line-height: 110%;
<span class='line-number'>191</span>	        }
<span class='line-number'>192</span>	
<span class='line-number'>193</span>	        h4 {
<span class='line-number'>194</span>	            display: block;
<span class='line-number'>195</span>	            font-size: 18px;
<span class='line-number'>196</span>	            font-style: italic;
<span class='line-number'>197</span>	            font-weight: normal;
<span class='line-number'>198</span>	            line-height: 100%;
<span class='line-number'>199</span>	        }
<span class='line-number'>200</span>	
<span class='line-number'>201</span>	        .flexibleImage {
<span class='line-number'>202</span>	            height: auto;
<span class='line-number'>203</span>	        }
<span class='line-number'>204</span>	
<span class='line-number'>205</span>	        .linkRemoveBorder {
<span class='line-number'>206</span>	            border-bottom: 0 !important;
<span class='line-number'>207</span>	        }
<span class='line-number'>208</span>	
<span class='line-number'>209</span>	        table[class=flexibleContainerCellDivider] {
<span class='line-number'>210</span>	            padding-bottom: 0 !important;
<span class='line-number'>211</span>	            padding-top: 0 !important;
<span class='line-number'>212</span>	        }
<span class='line-number'>213</span>	
<span class='line-number'>214</span>	        body, #bodyTable {
<span class='line-number'>215</span>	            background-color: #d3d3d3;
<span class='line-number'>216</span>	        }
<span class='line-number'>217</span>	
<span class='line-number'>218</span>	        #emailHeader {
<span class='line-number'>219</span>	            background-color: #d3d3d3;
<span class='line-number'>220</span>	        }
<span class='line-number'>221</span>	
<span class='line-number'>222</span>	        #emailBody {
<span class='line-number'>223</span>	            background-color: #FFFFFF;
<span class='line-number'>224</span>	        }
<span class='line-number'>225</span>	
<span class='line-number'>226</span>	        #emailFooter {
<span class='line-number'>227</span>	            background-color: #d3d3d3;
<span class='line-number'>228</span>	        }
<span class='line-number'>229</span>	
<span class='line-number'>230</span>	        .nestedContainer {
<span class='line-number'>231</span>	            background-color: #F8F8F8;
<span class='line-number'>232</span>	            border: 1px solid #CCCCCC;
<span class='line-number'>233</span>	        }
<span class='line-number'>234</span>	
<span class='line-number'>235</span>	        .emailButton {
<span class='line-number'>236</span>	            background-color: #265b8c;
<span class='line-number'>237</span>	            border-collapse: separate;
<span class='line-number'>238</span>	        }
<span class='line-number'>239</span>	
<span class='line-number'>240</span>	        .buttonContent {
<span class='line-number'>241</span>	            color: #FFFFFF;
<span class='line-number'>242</span>	            font-family: Helvetica;
<span class='line-number'>243</span>	            font-size: 18px;
<span class='line-number'>244</span>	            font-weight: bold;
<span class='line-number'>245</span>	            line-height: 100%;
<span class='line-number'>246</span>	            padding: 15px;
<span class='line-number'>247</span>	            text-align: center;
<span class='line-number'>248</span>	        }
<span class='line-number'>249</span>	
<span class='line-number'>250</span>	            .buttonContent a {
<span class='line-number'>251</span>	                color: #FFFFFF;
<span class='line-number'>252</span>	                display: block;
<span class='line-number'>253</span>	                text-decoration: none !important;
<span class='line-number'>254</span>	                border: 0 !important;
<span class='line-number'>255</span>	            }
<span class='line-number'>256</span>	
<span class='line-number'>257</span>	        .emailCalendar {
<span class='line-number'>258</span>	            background-color: #FFFFFF;
<span class='line-number'>259</span>	            border: 1px solid #CCCCCC;
<span class='line-number'>260</span>	        }
<span class='line-number'>261</span>	
<span class='line-number'>262</span>	        .emailCalendarMonth {
<span class='line-number'>263</span>	            background-color: #205478;
<span class='line-number'>264</span>	            color: #FFFFFF;
<span class='line-number'>265</span>	            font-family: Helvetica, Arial, sans-serif;
<span class='line-number'>266</span>	            font-size: 16px;
<span class='line-number'>267</span>	            font-weight: bold;
<span class='line-number'>268</span>	            padding-top: 10px;
<span class='line-number'>269</span>	            padding-bottom: 10px;
<span class='line-number'>270</span>	            text-align: center;
<span class='line-number'>271</span>	        }
<span class='line-number'>272</span>	
<span class='line-number'>273</span>	        .emailCalendarDay {
<span class='line-number'>274</span>	            color: #205478;
<span class='line-number'>275</span>	            font-family: Helvetica, Arial, sans-serif;
<span class='line-number'>276</span>	            font-size: 60px;
<span class='line-number'>277</span>	            font-weight: bold;
<span class='line-number'>278</span>	            line-height: 100%;
<span class='line-number'>279</span>	            padding-top: 20px;
<span class='line-number'>280</span>	            padding-bottom: 20px;
<span class='line-number'>281</span>	            text-align: center;
<span class='line-number'>282</span>	        }
<span class='line-number'>283</span>	
<span class='line-number'>284</span>	        .imageContentText {
<span class='line-number'>285</span>	            margin-top: 10px;
<span class='line-number'>286</span>	            line-height: 0;
<span class='line-number'>287</span>	        }
<span class='line-number'>288</span>	
<span class='line-number'>289</span>	            .imageContentText a {
<span class='line-number'>290</span>	                line-height: 0;
<span class='line-number'>291</span>	            }
<span class='line-number'>292</span>	
<span class='line-number'>293</span>	        #invisibleIntroduction {
<span class='line-number'>294</span>	            display: none !important;
<span class='line-number'>295</span>	        }
<span class='line-number'>296</span>	        /* Removing the introduction text from the view */
<span class='line-number'>297</span>	
<span class='line-number'>298</span>	        /*FRAMEWORK HACKS &amp; OVERRIDES */
<span class='line-number'>299</span>	        span[class=ios-color-hack] a {
<span class='line-number'>300</span>	            color: #275100 !important;
<span class='line-number'>301</span>	            text-decoration: none !important;
<span class='line-number'>302</span>	        }
<span class='line-number'>303</span>	        /* Remove all link colors in IOS (below are duplicates based on the color preference) */
<span class='line-number'>304</span>	        span[class=ios-color-hack2] a {
<span class='line-number'>305</span>	            color: #205478 !important;
<span class='line-number'>306</span>	            text-decoration: none !important;
<span class='line-number'>307</span>	        }
<span class='line-number'>308</span>	
<span class='line-number'>309</span>	        span[class=ios-color-hack3] a {
<span class='line-number'>310</span>	            color: #8B8B8B !important;
<span class='line-number'>311</span>	            text-decoration: none !important;
<span class='line-number'>312</span>	        }
<span class='line-number'>313</span>	        /* A nice and clean way to target phone numbers you want clickable and avoid a mobile phone from linking other numbers that look like, but are not phone numbers.  Use these two blocks of code to &quot;unstyle&quot; any numbers that may be linked.  The second block gives you a class to apply with a span tag to the numbers you would like linked and styled.
<span class='line-number'>314</span>	            Inspired by Campaign Monitor&#39;s article on using phone numbers in email: http://www.campaignmonitor.com/blog/post/3571/using-phone-numbers-in-html-email/.
<span class='line-number'>315</span>	            */
<span class='line-number'>316</span>	        .a[href^=&quot;tel&quot;], a[href^=&quot;sms&quot;] {
<span class='line-number'>317</span>	            text-decoration: none !important;
<span class='line-number'>318</span>	            color: #606060 !important;
<span class='line-number'>319</span>	            pointer-events: none !important;
<span class='line-number'>320</span>	            cursor: default !important;
<span class='line-number'>321</span>	        }
<span class='line-number'>322</span>	
<span class='line-number'>323</span>	        .mobile_link a[href^=&quot;tel&quot;], .mobile_link a[href^=&quot;sms&quot;] {
<span class='line-number'>324</span>	            text-decoration: none !important;
<span class='line-number'>325</span>	            color: #606060 !important;
<span class='line-number'>326</span>	            pointer-events: auto !important;
<span class='line-number'>327</span>	            cursor: default !important;
<span class='line-number'>328</span>	        }
<span class='line-number'>329</span>	
<span class='line-number'>330</span>	
<span class='line-number'>331</span>	        /* MOBILE STYLES */
<span class='line-number'>332</span>	        @@media only screen and (max-width: 480px) {
<span class='line-number'>333</span>	            /*////// CLIENT-SPECIFIC STYLES //////*/
<span class='line-number'>334</span>	            body {
<span class='line-number'>335</span>	                width: 100% !important;
<span class='line-number'>336</span>	                min-width: 100% !important;
<span class='line-number'>337</span>	            }
<span class='line-number'>338</span>	            /* Force iOS Mail to render the email at full width. */
<span class='line-number'>339</span>	
<span class='line-number'>340</span>	            /* FRAMEWORK STYLES */
<span class='line-number'>341</span>	            /*
<span class='line-number'>342</span>	                CSS selectors are written in attribute
<span class='line-number'>343</span>	                selector format to prevent Yahoo Mail
<span class='line-number'>344</span>	                from rendering media query styles on
<span class='line-number'>345</span>	                desktop.
<span class='line-number'>346</span>	                */
<span class='line-number'>347</span>	            /*td[class=&quot;textContent&quot;], td[class=&quot;flexibleContainerCell&quot;] { width: 100%; padding-left: 10px !important; padding-right: 10px !important; }*/
<span class='line-number'>348</span>	            table[id=&quot;emailHeader&quot;],
<span class='line-number'>349</span>	            table[id=&quot;emailBody&quot;],
<span class='line-number'>350</span>	            table[id=&quot;emailFooter&quot;],
<span class='line-number'>351</span>	            table[class=&quot;flexibleContainer&quot;],
<span class='line-number'>352</span>	            td[class=&quot;flexibleContainerCell&quot;] {
<span class='line-number'>353</span>	                width: 100% !important;
<span class='line-number'>354</span>	            }
<span class='line-number'>355</span>	
<span class='line-number'>356</span>	            td[class=&quot;flexibleContainerBox&quot;] table {
<span class='line-number'>357</span>	                display: block;
<span class='line-number'>358</span>	                width: 100%;
<span class='line-number'>359</span>	                text-align: left;
<span class='line-number'>360</span>	            }
<span class='line-number'>361</span>	            /*
<span class='line-number'>362</span>	                The following style rule makes any
<span class='line-number'>363</span>	                image classed with &#39;flexibleImage&#39;
<span class='line-number'>364</span>	                fluid when the query activates.
<span class='line-number'>365</span>	                Make sure you add an inline max-width
<span class='line-number'>366</span>	                to those images to prevent them
<span class='line-number'>367</span>	                from blowing out.
<span class='line-number'>368</span>	                */
<span class='line-number'>369</span>	            td[class=&quot;imageContent&quot;] img {
<span class='line-number'>370</span>	                height: auto !important;
<span class='line-number'>371</span>	                width: 100% !important;
<span class='line-number'>372</span>	                max-width: 100% !important;
<span class='line-number'>373</span>	            }
<span class='line-number'>374</span>	
<span class='line-number'>375</span>	            img[class=&quot;flexibleImage&quot;] {
<span class='line-number'>376</span>	                height: auto !important;
<span class='line-number'>377</span>	                width: 100% !important;
<span class='line-number'>378</span>	                max-width: 100% !important;
<span class='line-number'>379</span>	            }
<span class='line-number'>380</span>	
<span class='line-number'>381</span>	            img[class=&quot;flexibleImageSmall&quot;] {
<span class='line-number'>382</span>	                height: auto !important;
<span class='line-number'>383</span>	                width: auto !important;
<span class='line-number'>384</span>	            }
<span class='line-number'>385</span>	
<span class='line-number'>386</span>	
<span class='line-number'>387</span>	            /*
<span class='line-number'>388</span>	                Create top space for every second element in a block
<span class='line-number'>389</span>	                */
<span class='line-number'>390</span>	            table[class=&quot;flexibleContainerBoxNext&quot;] {
<span class='line-number'>391</span>	                padding-top: 10px !important;
<span class='line-number'>392</span>	            }
<span class='line-number'>393</span>	
<span class='line-number'>394</span>	            /*
<span class='line-number'>395</span>	                Make buttons in the email span the
<span class='line-number'>396</span>	                full width of their container, allowing
<span class='line-number'>397</span>	                for left- or right-handed ease of use.
<span class='line-number'>398</span>	                */
<span class='line-number'>399</span>	            table[class=&quot;emailButton&quot;] {
<span class='line-number'>400</span>	                width: 100% !important;
<span class='line-number'>401</span>	            }
<span class='line-number'>402</span>	
<span class='line-number'>403</span>	            td[class=&quot;buttonContent&quot;] {
<span class='line-number'>404</span>	                padding: 0 !important;
<span class='line-number'>405</span>	            }
<span class='line-number'>406</span>	
<span class='line-number'>407</span>	                td[class=&quot;buttonContent&quot;] a {
<span class='line-number'>408</span>	                    padding: 15px !important;
<span class='line-number'>409</span>	                }
<span class='line-number'>410</span>	        }
<span class='line-number'>411</span>	
<span class='line-number'>412</span>	        /*  CONDITIONS FOR ANDROID DEVICES ONLY
<span class='line-number'>413</span>	            *   http://developer.android.com/guide/webapps/targeting.html
<span class='line-number'>414</span>	            *   http://pugetworks.com/2011/04/css-media-queries-for-targeting-different-mobile-devices/ ;
<span class='line-number'>415</span>	            =====================================================*/
<span class='line-number'>416</span>	
<span class='line-number'>417</span>	        @@media only screen and (-webkit-device-pixel-ratio:.75) {
<span class='line-number'>418</span>	            /* Put CSS for low density (ldpi) Android layouts in here */
<span class='line-number'>419</span>	        }
<span class='line-number'>420</span>	
<span class='line-number'>421</span>	        @@media only screen and (-webkit-device-pixel-ratio:1) {
<span class='line-number'>422</span>	            /* Put CSS for medium density (mdpi) Android layouts in here */
<span class='line-number'>423</span>	        }
<span class='line-number'>424</span>	
<span class='line-number'>425</span>	        @@media only screen and (-webkit-device-pixel-ratio:1.5) {
<span class='line-number'>426</span>	            /* Put CSS for high density (hdpi) Android layouts in here */
<span class='line-number'>427</span>	        }
<span class='line-number'>428</span>	        /* end Android targeting */
<span class='line-number'>429</span>	
<span class='line-number'>430</span>	        /* CONDITIONS FOR IOS DEVICES ONLY
<span class='line-number'>431</span>	            =====================================================*/
<span class='line-number'>432</span>	        @@media only screen and (min-device-width : 320px) and (max-device-width:568px) {
<span class='line-number'>433</span>	        }
<span class='line-number'>434</span>	        /* end IOS targeting */
<span class='line-number'>435</span>	    &lt;/style&gt;
<span class='line-number'>436</span>	
<span class='line-number'>437</span>	&lt;/head&gt;
<span class='line-number'>438</span>	
<span class='line-number'>439</span>	&lt;body bgcolor=&quot;#d3d3d3&quot; leftmargin=&quot;0&quot; marginwidth=&quot;0&quot; topmargin=&quot;0&quot; marginheight=&quot;0&quot; offset=&quot;0&quot;&gt;
<span class='line-number'>440</span>	    &lt;center style=&quot;background-color:#d3d3d3;&quot;&gt;
<span class='line-number'>441</span>	        &lt;table border=&quot;0&quot; cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; height=&quot;100%&quot; width=&quot;100%&quot; id=&quot;bodyTable&quot; style=&quot;table-layout: fixed;max-width:100% !important;width: 100% !important;min-width: 100% !important;&quot;&gt;
<span class='line-number'>442</span>	            &lt;tr&gt;
<span class='line-number'>443</span>	                &lt;td align=&quot;center&quot; valign=&quot;top&quot; id=&quot;bodyCell&quot;&gt;
<span class='line-number'>444</span>	                    @inherits RazorTemplateBase&lt;RazorTemplateModel&lt;Template&gt;&gt;
<span class='line-number'>445</span>	@using Dynamicweb.Rendering;
<span class='line-number'>446</span>	
<span class='line-number'>447</span>	@inherits RazorTemplateBase&lt;RazorTemplateModel&lt;Template&gt;&gt;
<span class='line-number'>448</span>	@using Dynamicweb.Rendering;
<span class='line-number'>449</span>	@using System.Linq;
<span class='line-number'>450</span>	
<span class='line-number'>451</span>	@functions {
<span class='line-number'>452</span>	    string AddSpaceAfterCurrency(string str)
<span class='line-number'>453</span>	    {
<span class='line-number'>454</span>	        return str.Insert(str.IndexOfAny(&quot;0123456789-&quot;.ToCharArray()), &quot; &quot;);
<span class='line-number'>455</span>	    }
<span class='line-number'>456</span>	}
<span class='line-number'>457</span>	
<span class='line-number'>458</span>	@helper RenderHeaderImage()
<span class='line-number'>459</span>	{
<span class='line-number'>460</span>	    string logoimage = Pageview.Area.Item[&quot;EmailLogoImage&quot;].ToString();
<span class='line-number'>461</span>	
<span class='line-number'>462</span>	    Column header = new Column();
<span class='line-number'>463</span>	    header.image = logoimage;
<span class='line-number'>464</span>	    header.imageSize = &quot;250&quot;;
<span class='line-number'>465</span>	    header.align = &quot;center&quot;;
<span class='line-number'>466</span>	
<span class='line-number'>467</span>	    @CreateRow(header, new RowSettings { backgroundColor = &quot;#00325e&quot; });
<span class='line-number'>468</span>	}
<span class='line-number'>469</span>	
<span class='line-number'>470</span>	@helper RenderFooterSection()
<span class='line-number'>471</span>	{
<span class='line-number'>472</span>	    string logoimage = Pageview.Area.Item[&quot;EmailLogoImage&quot;].ToString();
<span class='line-number'>473</span>	
<span class='line-number'>474</span>	    Column footerRight = new Column();
<span class='line-number'>475</span>	    footerRight.textColor = &quot;#FFF&quot;;
<span class='line-number'>476</span>	    footerRight.image = logoimage;
<span class='line-number'>477</span>	    footerRight.imageSize = &quot;200&quot;;
<span class='line-number'>478</span>	    footerRight.align = &quot;right&quot;;
<span class='line-number'>479</span>	
<span class='line-number'>480</span>	    string footeremail = Dynamicweb.Core.Converter.ToString(Pageview.Area.Item[&quot;ContactEmail&quot;]);
<span class='line-number'>481</span>	    string footerphone = Dynamicweb.Core.Converter.ToString(Pageview.Area.Item[&quot;ContactNumber&quot;]).Replace(&quot; &quot;, &quot;&quot;);
<span class='line-number'>482</span>	
<span class='line-number'>483</span>	    footerRight.text.Add(&quot;&lt;a href=&#39;tel:&quot; + footerphone + &quot;&#39; style=&#39;color: white; text-decoration: none; border-bottom: 0;&#39;&gt;&quot; + footerphone + &quot;&lt;/a&gt;&quot;);
<span class='line-number'>484</span>	    footerRight.text.Add(&quot;&lt;a href=&#39;mailto:&quot; + footeremail + &quot;&#39; style=&#39;color: white; text-decoration: none; border-bottom: 0;&#39; title=&#39;Email Us&#39;&gt;&quot; + footeremail + &quot;&lt;/a&gt;&quot;);
<span class='line-number'>485</span>	    footerRight.text.Add(&quot;&quot;);
<span class='line-number'>486</span>	    /*
<span class='line-number'>487</span>	    string iconsHTML = &quot;&quot;;
<span class='line-number'>488</span>	
<span class='line-number'>489</span>	    var socialLinksListId = Dynamicweb.Core.Converter.ToInt32(Pageview.Area.Item[&quot;FooterSocialLinks&quot;]);
<span class='line-number'>490</span>	    if (socialLinksListId &gt; 0)
<span class='line-number'>491</span>	    {
<span class='line-number'>492</span>	        var socialLinksList = Dynamicweb.Content.Items.ItemList.GetItemListById(socialLinksListId);
<span class='line-number'>493</span>	        if (socialLinksList != null) { 
<span class='line-number'>494</span>	            foreach (var socialLinkItem in socialLinksList.Relations)
<span class='line-number'>495</span>	            {
<span class='line-number'>496</span>	                var values = new Dictionary&lt;string, object&gt;();
<span class='line-number'>497</span>	                socialLinkItem.SerializeTo(values);
<span class='line-number'>498</span>	                
<span class='line-number'>499</span>	                string socialLink = values[&quot;Link&quot;].ToString();
<span class='line-number'>500</span>	                string socialIconClass = values[&quot;Icon&quot;].ToString();
<span class='line-number'>501</span>	
<span class='line-number'>502</span>	                iconsHTML += &quot; &lt;a href=&#39;&quot; + socialLink + &quot;&#39; style=&#39;color: white; text-decoration: none; border-bottom: 0;&#39;&gt;&lt;i class=&#39;fa &quot; + socialIconClass + &quot; fa-2x u-color-light&#39;&gt;&lt;/i&gt;&lt;/a&gt;&quot;;
<span class='line-number'>503</span>	            }
<span class='line-number'>504</span>	        }
<span class='line-number'>505</span>	        footerRight.text.Add(iconsHTML);
<span class='line-number'>506</span>	    }
<span class='line-number'>507</span>	    */
<span class='line-number'>508</span>	    @CreateRow(footerRight, new RowSettings { backgroundColor = &quot;#00325e&quot; });
<span class='line-number'>509</span>	}
<span class='line-number'>510</span>	
<span class='line-number'>511</span>	@helper RenderRecurringDetails()
<span class='line-number'>512</span>	{
<span class='line-number'>513</span>	    if (GetBoolean(&quot;Ecom:Order.IsRecurringOrder&quot;))
<span class='line-number'>514</span>	    {
<span class='line-number'>515</span>	        Column recurringInfo = new Column();
<span class='line-number'>516</span>	        recurringInfo.text.Add(Translate(&quot;You have placed a subscription. This is a confirmation of the subscription not the actual order receipt.&quot;));
<span class='line-number'>517</span>	        recurringInfo.align = &quot;center&quot;;
<span class='line-number'>518</span>	
<span class='line-number'>519</span>	        @CreateRow(recurringInfo);
<span class='line-number'>520</span>	
<span class='line-number'>521</span>	        @CreateRowDivider();
<span class='line-number'>522</span>	    }
<span class='line-number'>523</span>	
<span class='line-number'>524</span>	    if (GetBoolean(&quot;Ecom:Order.IsBasedOnRecurringOrder&quot;))
<span class='line-number'>525</span>	    {
<span class='line-number'>526</span>	        Column basedRecurringInfo = new Column();
<span class='line-number'>527</span>	        basedRecurringInfo.text.Add(Translate(&quot;Your subscription order&quot;));
<span class='line-number'>528</span>	        basedRecurringInfo.align = &quot;center&quot;;
<span class='line-number'>529</span>	
<span class='line-number'>530</span>	        @CreateRow(basedRecurringInfo);
<span class='line-number'>531</span>	
<span class='line-number'>532</span>	        @CreateRowDivider();
<span class='line-number'>533</span>	    }
<span class='line-number'>534</span>	}
<span class='line-number'>535</span>	
<span class='line-number'>536</span>	@helper RenderComments()
<span class='line-number'>537</span>	{
<span class='line-number'>538</span>	    if (!string.IsNullOrWhiteSpace(GetString(&quot;Ecom:Order.Customer.Comment&quot;)))
<span class='line-number'>539</span>	    {
<span class='line-number'>540</span>	        Column comment = new Column();
<span class='line-number'>541</span>	        comment.subheader = Translate(&quot;Comment&quot;);
<span class='line-number'>542</span>	        comment.text.Add(GetString(&quot;Ecom:Order.Customer.Comment&quot;));
<span class='line-number'>543</span>	        
<span class='line-number'>544</span>	        @CreateRow(comment);
<span class='line-number'>545</span>	
<span class='line-number'>546</span>	        @CreateRowDivider();
<span class='line-number'>547</span>	    } 
<span class='line-number'>548</span>	}
<span class='line-number'>549</span>	
<span class='line-number'>550</span>	@helper RenderAddresses(string billingTitle, string deliveryTitle, string prefix)
<span class='line-number'>551</span>	{ 
<span class='line-number'>552</span>	    //Billing information
<span class='line-number'>553</span>	    Column billingInfo = new Column();
<span class='line-number'>554</span>	
<span class='line-number'>555</span>	    var billingInfoList = new string[] {
<span class='line-number'>556</span>	        GetString(&quot;Ecom:&quot; + prefix + &quot;.Customer.Name&quot;),
<span class='line-number'>557</span>	        GetString(&quot;Ecom:&quot; + prefix + &quot;.Customer.Address&quot;),
<span class='line-number'>558</span>	        GetString(&quot;Ecom:&quot; + prefix + &quot;.Customer.Address2&quot;),
<span class='line-number'>559</span>	        GetString(&quot;Ecom:&quot; + prefix + &quot;.Customer.Zip&quot;) + &quot; &quot; + GetString(&quot;Ecom:&quot; + prefix + &quot;.Customer.City&quot;),
<span class='line-number'>560</span>	        GetString(&quot;Ecom:&quot; + prefix + &quot;.Customer.Country&quot;),
<span class='line-number'>561</span>	        GetString(&quot;Ecom:&quot; + prefix + &quot;.Customer.Email&quot;),
<span class='line-number'>562</span>	        GetString(&quot;Ecom:&quot; + prefix + &quot;.Customer.Phone&quot;),
<span class='line-number'>563</span>	        GetString(&quot;Ecom:&quot; + prefix + &quot;.Customer.EAN&quot;),
<span class='line-number'>564</span>	        GetString(&quot;Ecom:&quot; + prefix + &quot;.Customer.Fax&quot;),
<span class='line-number'>565</span>	        GetString(&quot;Ecom:&quot; + prefix + &quot;.Customer.Cell&quot;)
<span class='line-number'>566</span>	    };
<span class='line-number'>567</span>	
<span class='line-number'>568</span>	    foreach (var infoListObject in billingInfoList.Where(i =&gt; !string.IsNullOrEmpty(i)))
<span class='line-number'>569</span>	    {
<span class='line-number'>570</span>	        billingInfo.text.Add(infoListObject);
<span class='line-number'>571</span>	    }
<span class='line-number'>572</span>	
<span class='line-number'>573</span>	    //Delivery information
<span class='line-number'>574</span>	    Column shippingInfo = new Column();
<span class='line-number'>575</span>	
<span class='line-number'>576</span>	    var shippingInfoList = new string[] {
<span class='line-number'>577</span>	        GetString(&quot;Ecom:&quot; + prefix + &quot;.Delivery.Name&quot;),
<span class='line-number'>578</span>	        GetString(&quot;Ecom:&quot; + prefix + &quot;.Delivery.Address&quot;),
<span class='line-number'>579</span>	        GetString(&quot;Ecom:&quot; + prefix + &quot;.Delivery.Address2&quot;),
<span class='line-number'>580</span>	        GetString(&quot;Ecom:&quot; + prefix + &quot;.Delivery.Zip&quot;) + &quot; &quot; + GetString(&quot;Ecom:&quot; + prefix + &quot;.Delivery.City&quot;),
<span class='line-number'>581</span>	        GetString(&quot;Ecom:&quot; + prefix + &quot;.Delivery.Country&quot;),
<span class='line-number'>582</span>	        GetString(&quot;Ecom:&quot; + prefix + &quot;.Delivery.Email&quot;),
<span class='line-number'>583</span>	        GetString(&quot;Ecom:&quot; + prefix + &quot;.Delivery.Phone&quot;),
<span class='line-number'>584</span>	        GetString(&quot;Ecom:&quot; + prefix + &quot;.Delivery.EAN&quot;),
<span class='line-number'>585</span>	        GetString(&quot;Ecom:&quot; + prefix + &quot;.Delivery.Fax&quot;),
<span class='line-number'>586</span>	        GetString(&quot;Ecom:&quot; + prefix + &quot;.Delivery.Cell&quot;)
<span class='line-number'>587</span>	    };
<span class='line-number'>588</span>	
<span class='line-number'>589</span>	    //Reuse billing address, if there is no shipping address
<span class='line-number'>590</span>	    if (!String.IsNullOrEmpty(GetString(&quot;Ecom:&quot; + prefix + &quot;.Delivery.Address&quot;)))
<span class='line-number'>591</span>	    {
<span class='line-number'>592</span>	        foreach (var infoListObject in shippingInfoList.Where(i =&gt; !string.IsNullOrEmpty(i)))
<span class='line-number'>593</span>	        {
<span class='line-number'>594</span>	            shippingInfo.text.Add(infoListObject);
<span class='line-number'>595</span>	        }
<span class='line-number'>596</span>	    }
<span class='line-number'>597</span>	    else
<span class='line-number'>598</span>	    {
<span class='line-number'>599</span>	        foreach (var infoListObject in billingInfoList.Where(i =&gt; !string.IsNullOrEmpty(i)))
<span class='line-number'>600</span>	        {
<span class='line-number'>601</span>	            shippingInfo.text.Add(infoListObject);
<span class='line-number'>602</span>	        }
<span class='line-number'>603</span>	    }
<span class='line-number'>604</span>	
<span class='line-number'>605</span>	    @CreateRow(billingInfo, shippingInfo, new RowSettings { backgroundColor = &quot;#e4e4e4&quot; });
<span class='line-number'>606</span>	}
<span class='line-number'>607</span>	
<span class='line-number'>608</span>	@helper RenderPaymentAndShipping()
<span class='line-number'>609</span>	{ 
<span class='line-number'>610</span>	    Column paymentInfo = new Column();
<span class='line-number'>611</span>	    Column shippingInfo = new Column();
<span class='line-number'>612</span>	
<span class='line-number'>613</span>	    //Payment information
<span class='line-number'>614</span>	    if (!string.IsNullOrEmpty(GetString(&quot;Ecom:Order.PaymentMethod&quot;)))
<span class='line-number'>615</span>	    {
<span class='line-number'>616</span>	        string image = &quot;http://&quot; + GetGlobalValue(&quot;Global:Request.Host&quot;) + &quot;/Admin/Public/GetImage.ashx?width=16&amp;crop=1&amp;image=&quot; + &quot;/Files/Images/payment.png&quot;;
<span class='line-number'>617</span>	        paymentInfo.text.Add(Translate(&quot;Payment method&quot;) + &quot;: &quot; + GetString(&quot;Ecom:Order.PaymentMethod&quot;));
<span class='line-number'>618</span>	        paymentInfo.text.Add(Translate(&quot;Card no&quot;) + &quot;: &quot; + GetString(&quot;Ecom:Order.TransactionCardNumber&quot;));
<span class='line-number'>619</span>	        paymentInfo.text.Add(Translate(&quot;Transaction no&quot;) + &quot;: &quot; + GetString(&quot;Ecom:Order.TransactionNumber&quot;));
<span class='line-number'>620</span>	        paymentInfo.text.Add(Translate(&quot;Transaction status&quot;) + &quot;: &quot; + GetString(&quot;Ecom:Order.TransactionStatus&quot;));
<span class='line-number'>621</span>	    }
<span class='line-number'>622</span>	
<span class='line-number'>623</span>	    //Shipping information
<span class='line-number'>624</span>	    if (!string.IsNullOrEmpty(GetString(&quot;Ecom:Order.ShippingMethod&quot;)))
<span class='line-number'>625</span>	    {
<span class='line-number'>626</span>	        string image = &quot;http://&quot; + GetGlobalValue(&quot;Global:Request.Host&quot;) + &quot;/Admin/Public/GetImage.ashx?width=16&amp;crop=1&amp;image=&quot; + &quot;/Files/Images/shipping.png&quot;;
<span class='line-number'>627</span>	        shippingInfo.text.Add(Translate(&quot;Shipping method&quot;) + &quot;: &quot; + GetString(&quot;Ecom:Order.ShippingMethod&quot;));
<span class='line-number'>628</span>	    }
<span class='line-number'>629</span>	
<span class='line-number'>630</span>	    @CreateRow(paymentInfo, shippingInfo, new RowSettings { backgroundColor = &quot;#e4e4e4&quot; });
<span class='line-number'>631</span>	}
<span class='line-number'>632</span>	
<span class='line-number'>633</span>	@helper RenderOrderline(LoopItem orderline, bool showImage = true) 
<span class='line-number'>634</span>	{
<span class='line-number'>635</span>	    Column orderLineLeft = new Column();
<span class='line-number'>636</span>	
<span class='line-number'>637</span>	    Column orderLineCenter = new Column();
<span class='line-number'>638</span>	
<span class='line-number'>639</span>	    Column orderLineRight = new Column();
<span class='line-number'>640</span>	    orderLineRight.align = &quot;right&quot;;
<span class='line-number'>641</span>	
<span class='line-number'>642</span>	    if (orderline.GetString(&quot;Ecom:Order:OrderLine.Type&quot;) == &quot;1&quot; || orderline.GetString(&quot;Ecom:Order:OrderLine.Type&quot;) == &quot;3&quot; || orderline.GetString(&quot;Ecom:Order:OrderLine.Type&quot;) == &quot;4&quot;)
<span class='line-number'>643</span>	    {
<span class='line-number'>644</span>	        //Discount
<span class='line-number'>645</span>	        orderLineCenter.text.Add(orderline.GetString(&quot;Ecom:Order:OrderLine.ProductName&quot;));
<span class='line-number'>646</span>	
<span class='line-number'>647</span>	        orderLineRight.text.Add(&quot;&lt;strong&gt;&quot; + AddSpaceAfterCurrency(orderline.GetString(&quot;Ecom:Order:OrderLine.TotalPrice&quot;)) + &quot;&lt;/strong&gt;&quot;);
<span class='line-number'>648</span>	
<span class='line-number'>649</span>	        @CreateRow(orderLineCenter, orderLineRight);
<span class='line-number'>650</span>	    }
<span class='line-number'>651</span>	    else
<span class='line-number'>652</span>	    {   
<span class='line-number'>653</span>	        if (showImage) {
<span class='line-number'>654</span>	            orderLineLeft.image = orderline.GetString(&quot;Ecom:Product.ImageSmall.Default.Clean&quot;);
<span class='line-number'>655</span>	        }
<span class='line-number'>656</span>	
<span class='line-number'>657</span>	        //Product
<span class='line-number'>658</span>	        orderLineCenter.text.Add(orderline.GetString(&quot;Ecom:Order:OrderLine.ProductName&quot;));
<span class='line-number'>659</span>	
<span class='line-number'>660</span>	        orderLineCenter.text.Add(&quot;# &quot; + orderline.GetString(&quot;Ecom:Order:OrderLine.ProductNumber&quot;));
<span class='line-number'>661</span>	
<span class='line-number'>662</span>	        if (!string.IsNullOrWhiteSpace(orderline.GetString(&quot;Ecom:Order:OrderLine.ProductVariantText&quot;)))
<span class='line-number'>663</span>	        {
<span class='line-number'>664</span>	            orderLineCenter.text.Add(orderline.GetString(&quot;Ecom:Order:OrderLine.ProductVariantText&quot;));
<span class='line-number'>665</span>	        }
<span class='line-number'>666</span>	
<span class='line-number'>667</span>	        orderLineCenter.text.Add(Translate(&quot;Qty&quot;) + &quot;: &quot; + orderline.GetString(&quot;Ecom:Order:OrderLine.Quantity&quot;));
<span class='line-number'>668</span>	
<span class='line-number'>669</span>	        orderLineRight.text.Add(&quot;&lt;strong&gt;&quot; + AddSpaceAfterCurrency(orderline.GetString(&quot;Ecom:Order:OrderLine.TotalPrice&quot;)) + &quot;&lt;/strong&gt;&quot;);
<span class='line-number'>670</span>	        
<span class='line-number'>671</span>	        if (showImage) 
<span class='line-number'>672</span>	        {
<span class='line-number'>673</span>	            orderLineLeft.width = &quot;105&quot;;
<span class='line-number'>674</span>	            orderLineLeft.imageSize = &quot;105&quot;;
<span class='line-number'>675</span>	            orderLineCenter.width = &quot;165&quot;;
<span class='line-number'>676</span>	            orderLineRight.width = &quot;110&quot;;
<span class='line-number'>677</span>	            @CreateRow(orderLineLeft, orderLineCenter, orderLineRight);
<span class='line-number'>678</span>	        }
<span class='line-number'>679</span>	        else
<span class='line-number'>680</span>	        {
<span class='line-number'>681</span>	            orderLineCenter.width = &quot;270&quot;;
<span class='line-number'>682</span>	            orderLineRight.width = &quot;110&quot;;
<span class='line-number'>683</span>	            @CreateRow(orderLineCenter, orderLineRight);
<span class='line-number'>684</span>	        }
<span class='line-number'>685</span>	        //BOM Items
<span class='line-number'>686</span>	        foreach (LoopItem bomitem in orderline.GetLoop(&quot;BOMItems&quot;))
<span class='line-number'>687</span>	        {
<span class='line-number'>688</span>	            var bomImage = bomitem.GetString(&quot;Ecom:Product.ImageSmall.Default.Clean&quot;);
<span class='line-number'>689</span>	
<span class='line-number'>690</span>	            Column bomLineLeft = new Column();
<span class='line-number'>691</span>	            if (showImage) {
<span class='line-number'>692</span>	                bomLineLeft.image = bomImage;
<span class='line-number'>693</span>	            }
<span class='line-number'>694</span>	            Column bomLineCenter = new Column();
<span class='line-number'>695</span>	            bomLineCenter.text.Add(bomitem.GetString(&quot;Ecom:Order:OrderLine.ProductName&quot;));
<span class='line-number'>696</span>	            bomLineCenter.text.Add(&quot;# &quot; + bomitem.GetString(&quot;Ecom:Order:OrderLine.ProductNumber&quot;));
<span class='line-number'>697</span>	            bomLineCenter.text.Add(Translate(&quot;Qty&quot;) + &quot;: &quot; + bomitem.GetString(&quot;Ecom:Order:OrderLine.Quantity&quot;));
<span class='line-number'>698</span>	                
<span class='line-number'>699</span>	            Column bomLineRight = new Column();
<span class='line-number'>700</span>	            bomLineRight.text.Add(&quot;&lt;strong&gt;&quot; + AddSpaceAfterCurrency(bomitem.GetString(&quot;Ecom:Order:OrderLine.TotalPrice&quot;)) + &quot;&lt;/strong&gt;&quot;);
<span class='line-number'>701</span>	            bomLineRight.align = &quot;right&quot;;
<span class='line-number'>702</span>	
<span class='line-number'>703</span>	            if (showImage) 
<span class='line-number'>704</span>	            {
<span class='line-number'>705</span>	                bomLineLeft.width = &quot;105&quot;;
<span class='line-number'>706</span>	                bomLineLeft.imageSize = &quot;105&quot;;
<span class='line-number'>707</span>	                bomLineCenter.width = &quot;165&quot;;
<span class='line-number'>708</span>	                bomLineRight.width = &quot;110&quot;;
<span class='line-number'>709</span>	                @CreateRow(bomLineLeft, bomLineCenter, bomLineRight, new RowSettings { backgroundColor = &quot;#e4e4e4&quot; });
<span class='line-number'>710</span>	            } 
<span class='line-number'>711</span>	            else 
<span class='line-number'>712</span>	            {
<span class='line-number'>713</span>	                bomLineCenter.width = &quot;270&quot;;
<span class='line-number'>714</span>	                bomLineRight.width = &quot;110&quot;;
<span class='line-number'>715</span>	                @CreateRow(bomLineCenter, bomLineRight, new RowSettings { backgroundColor = &quot;#e4e4e4&quot; });
<span class='line-number'>716</span>	            }
<span class='line-number'>717</span>	        }
<span class='line-number'>718</span>	    }
<span class='line-number'>719</span>	    @CreateRowDivider()
<span class='line-number'>720</span>	}
<span class='line-number'>721</span>	
<span class='line-number'>722</span>	@helper RenderProduct(LoopItem product) 
<span class='line-number'>723</span>	{
<span class='line-number'>724</span>	    Column productLeft = new Column();
<span class='line-number'>725</span>	
<span class='line-number'>726</span>	    Column productCenter = new Column();
<span class='line-number'>727</span>	
<span class='line-number'>728</span>	    Column productRight = new Column();
<span class='line-number'>729</span>	    productRight.align = &quot;right&quot;;
<span class='line-number'>730</span>	
<span class='line-number'>731</span>	    //Product
<span class='line-number'>732</span>	    productLeft.image = product.GetString(&quot;Ecom:Product.ImageLarge.Default.Clean&quot;);
<span class='line-number'>733</span>	
<span class='line-number'>734</span>	    productCenter.text.Add(product.GetString(&quot;Ecom:Product.Name&quot;));
<span class='line-number'>735</span>	
<span class='line-number'>736</span>	    productCenter.text.Add(&quot;# &quot; + product.GetString(&quot;Ecom:Product.Number&quot;));
<span class='line-number'>737</span>	
<span class='line-number'>738</span>	    if (!string.IsNullOrWhiteSpace(product.GetString(&quot;Ecom:Product.VariantText&quot;)))
<span class='line-number'>739</span>	    {
<span class='line-number'>740</span>	        productCenter.text.Add(product.GetString(&quot;Ecom:Product.VariantText&quot;));
<span class='line-number'>741</span>	    }
<span class='line-number'>742</span>	
<span class='line-number'>743</span>	    productRight.text.Add(&quot;&lt;strong&gt;&quot; + AddSpaceAfterCurrency(product.GetString(&quot;Ecom:Product.Price&quot;)) + &quot;&lt;/strong&gt;&quot;);
<span class='line-number'>744</span>	        
<span class='line-number'>745</span>	    productLeft.width = &quot;105&quot;;
<span class='line-number'>746</span>	    productLeft.imageSize = &quot;105&quot;;
<span class='line-number'>747</span>	    productCenter.width = &quot;165&quot;;
<span class='line-number'>748</span>	    productRight.width = &quot;110&quot;;
<span class='line-number'>749</span>	
<span class='line-number'>750</span>	    @CreateRow(productLeft, productCenter, productRight);
<span class='line-number'>751</span>	    /*
<span class='line-number'>752</span>	    //BOM Items
<span class='line-number'>753</span>	    foreach (LoopItem bomitem in product.GetLoop(&quot;BOMItems&quot;))
<span class='line-number'>754</span>	    {
<span class='line-number'>755</span>	        var bomImage = bomitem.GetString(&quot;Ecom:Product.ImageSmall.Default.Clean&quot;);
<span class='line-number'>756</span>	
<span class='line-number'>757</span>	        Column bomLineLeft = new Column();
<span class='line-number'>758</span>	        bomLineLeft.image = bomImage;
<span class='line-number'>759</span>	        Column bomLineCenter = new Column();
<span class='line-number'>760</span>	        bomLineCenter.text.Add(bomitem.GetString(&quot;Ecom:Product.Name&quot;));
<span class='line-number'>761</span>	        bomLineCenter.text.Add(&quot;# &quot; + bomitem.GetString(&quot;Ecom:Product.ID&quot;));
<span class='line-number'>762</span>	        bomLineCenter.text.Add(Translate(&quot;Qty&quot;) + &quot;: &quot; + bomitem.GetString(&quot;Ecom:Product.Quantity&quot;));
<span class='line-number'>763</span>	                
<span class='line-number'>764</span>	        Column bomLineRight = new Column();
<span class='line-number'>765</span>	        bomLineRight.text.Add(&quot;&lt;strong&gt;&quot; + AddSpaceAfterCurrency(bomitem.GetString(&quot;Ecom:Product.Price&quot;)) + &quot;&lt;/strong&gt;&quot;);
<span class='line-number'>766</span>	        bomLineRight.align = &quot;right&quot;;
<span class='line-number'>767</span>	        
<span class='line-number'>768</span>	        @CreateRow(bomLineLeft, bomLineCenter, bomLineRight, new RowSettings { backgroundColor = &quot;#e4e4e4&quot; });
<span class='line-number'>769</span>	    }*/
<span class='line-number'>770</span>	
<span class='line-number'>771</span>	    @CreateRowDivider()
<span class='line-number'>772</span>	}
<span class='line-number'>773</span>	
<span class='line-number'>774</span>	
<span class='line-number'>775</span>	@helper RenderGiftcards()
<span class='line-number'>776</span>	{ 
<span class='line-number'>777</span>	    if (!string.IsNullOrWhiteSpace(GetString(&quot;Ecom:Order.HasGiftCards&quot;)))
<span class='line-number'>778</span>	    {
<span class='line-number'>779</span>	        Column giftcardHeader = new Column();
<span class='line-number'>780</span>	        giftcardHeader.header = Translate(&quot;Giftcards bought on this order&quot;);
<span class='line-number'>781</span>	        giftcardHeader.align = &quot;center&quot;;
<span class='line-number'>782</span>	
<span class='line-number'>783</span>	        @CreateRow(giftcardHeader);
<span class='line-number'>784</span>	
<span class='line-number'>785</span>	        @CreateRowDivider();
<span class='line-number'>786</span>	
<span class='line-number'>787</span>	        foreach (LoopItem giftcards in GetLoop(&quot;GiftCards&quot;))
<span class='line-number'>788</span>	        {
<span class='line-number'>789</span>	            Column giftcardCode = new Column();
<span class='line-number'>790</span>	            giftcardCode.subheader = Translate(&quot;Gift card code&quot;) + &quot;: &quot; + giftcards.GetString(&quot;Ecom:Order.GiftCard.Code&quot;);
<span class='line-number'>791</span>	
<span class='line-number'>792</span>	            @CreateRow(giftcardCode);
<span class='line-number'>793</span>	
<span class='line-number'>794</span>	            Column giftcardLeft = new Column();
<span class='line-number'>795</span>	            giftcardLeft.text.Add(&quot;&lt;strong&gt;&quot; + giftcards.GetString(&quot;Ecom:Order.GiftCard.Name&quot;) + &quot;&lt;/strong&gt;&quot;);
<span class='line-number'>796</span>	            giftcardLeft.text.Add(Translate(&quot;Expiry date&quot;) + &quot;: &quot; + giftcards.GetString(&quot;Ecom:Order.GiftCard.ExpiryDate&quot;));
<span class='line-number'>797</span>	
<span class='line-number'>798</span>	            Column giftcardRight = new Column();
<span class='line-number'>799</span>	            giftcardRight.subheader = giftcards.GetString(&quot;Ecom:Order.GiftCard.Amount&quot;);
<span class='line-number'>800</span>	            giftcardRight.align = &quot;right&quot;;
<span class='line-number'>801</span>	
<span class='line-number'>802</span>	            @CreateRow(giftcardLeft, giftcardRight);
<span class='line-number'>803</span>	
<span class='line-number'>804</span>	            @CreateRowDivider();
<span class='line-number'>805</span>	        }
<span class='line-number'>806</span>	    } 
<span class='line-number'>807</span>	
<span class='line-number'>808</span>	    if (!string.IsNullOrWhiteSpace(GetString(&quot;Ecom:Order.HasUsedGiftCards&quot;)))
<span class='line-number'>809</span>	    {
<span class='line-number'>810</span>	        Column usedGiftcardHeader = new Column();
<span class='line-number'>811</span>	        usedGiftcardHeader.subheader = Translate(&quot;Order used gift cards&quot;);
<span class='line-number'>812</span>	        usedGiftcardHeader.align = &quot;center&quot;;
<span class='line-number'>813</span>	
<span class='line-number'>814</span>	        @CreateRow(usedGiftcardHeader);
<span class='line-number'>815</span>	
<span class='line-number'>816</span>	        @CreateRowDivider();
<span class='line-number'>817</span>	
<span class='line-number'>818</span>	        foreach (LoopItem usedgiftcards in GetLoop(&quot;UsedGiftCards&quot;))
<span class='line-number'>819</span>	        {
<span class='line-number'>820</span>	            Column giftcardLeft = new Column();
<span class='line-number'>821</span>	            giftcardLeft.subheader = usedgiftcards.GetString(&quot;Ecom:Order.UsedGiftCard.Code&quot;);
<span class='line-number'>822</span>	            giftcardLeft.text.Add(usedgiftcards.GetString(&quot;Ecom:Order.UsedGiftCard.Name&quot;));
<span class='line-number'>823</span>	            giftcardLeft.text.Add(Translate(&quot;Expiry date&quot;) + &quot; &quot; + usedgiftcards.GetString(&quot;Ecom:Order.UsedGiftCard.ExpiryDate&quot;));
<span class='line-number'>824</span>	
<span class='line-number'>825</span>	            Column giftcardRight = new Column();
<span class='line-number'>826</span>	            giftcardRight.subheader = usedgiftcards.GetString(&quot;Ecom:Order.UsedGiftCard.InitialAmount&quot;);
<span class='line-number'>827</span>	            giftcardRight.text.Add(usedgiftcards.GetString(&quot;Ecom:Order.UsedGiftCard.UsedAmountForTheOrder&quot;));
<span class='line-number'>828</span>	            giftcardRight.text.Add(usedgiftcards.GetString(&quot;Ecom:Order.UsedGiftCard.RemainingBalance&quot;));
<span class='line-number'>829</span>	            giftcardRight.align = &quot;right&quot;;
<span class='line-number'>830</span>	
<span class='line-number'>831</span>	            @CreateRow(giftcardLeft, giftcardRight);
<span class='line-number'>832</span>	
<span class='line-number'>833</span>	            @CreateRowDivider();
<span class='line-number'>834</span>	        }
<span class='line-number'>835</span>	    }
<span class='line-number'>836</span>	}
<span class='line-number'>837</span>	
<span class='line-number'>838</span>	@helper RenderButton(string link, string text)
<span class='line-number'>839</span>	{
<span class='line-number'>840</span>	    Column button = new Column();
<span class='line-number'>841</span>	    button.link = link;
<span class='line-number'>842</span>	    button.linkText = Translate(text);
<span class='line-number'>843</span>	    button.align = &quot;center&quot;;
<span class='line-number'>844</span>	    @CreateRow(button);
<span class='line-number'>845</span>	}
<span class='line-number'>846</span>	
<span class='line-number'>847</span>	@CreatePreheader()
<span class='line-number'>848</span>	
<span class='line-number'>849</span>	&lt;table bgcolor=&quot;#FFFFFF&quot; border=&quot;0&quot; cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; width=&quot;500&quot; id=&quot;emailBody&quot;&gt;
<span class='line-number'>850</span>	    @RenderHeaderSection()
<span class='line-number'>851</span>	    @RenderMessage()  
<span class='line-number'>852</span>	    @RenderFooterSection()
<span class='line-number'>853</span>	&lt;/table&gt;
<span class='line-number'>854</span>	
<span class='line-number'>855</span>	@helper RenderHeaderSection()
<span class='line-number'>856</span>	{
<span class='line-number'>857</span>	    @RenderHeaderImage();
<span class='line-number'>858</span>	}
<span class='line-number'>859</span>	
<span class='line-number'>860</span>	@helper RenderMessage()
<span class='line-number'>861</span>	{
<span class='line-number'>862</span>	    Column message = new Column();
<span class='line-number'>863</span>	    message.header = Translate(&quot;Password recovery&quot;);
<span class='line-number'>864</span>	    message.text.Add(&quot;&quot;);
<span class='line-number'>865</span>	
<span class='line-number'>866</span>	    if (!string.IsNullOrWhiteSpace(GetString(&quot;DWPasswordRecoveryUrl&quot;)))
<span class='line-number'>867</span>	    {
<span class='line-number'>868</span>	        message.text.Add(Translate(&quot;Hi&quot;) + &quot; &quot; + GetString(&quot;DWExtranetUsername&quot;) + &quot;, &quot;);
<span class='line-number'>869</span>	        message.text.Add(&quot;&quot;);
<span class='line-number'>870</span>	        message.text.Add(Translate(&quot;We have received a request to reset your password for your account.&quot;));
<span class='line-number'>871</span>	        message.text.Add(Translate(&quot;Click on the link below to set a new password.&quot;));
<span class='line-number'>872</span>	        @CreateRow(message);
<span class='line-number'>873</span>	        
<span class='line-number'>874</span>	        @RenderButton(GetString(&quot;DWPasswordRecoveryUrl&quot;), &quot;Reset password&quot;);
<span class='line-number'>875</span>	
<span class='line-number'>876</span>	        Column messageEnd = new Column();
<span class='line-number'>877</span>	        messageEnd.text.Add(Translate(&quot;If you didn&#39;t ask to change your password, ignore this email and your password will not be changed.&quot;));
<span class='line-number'>878</span>	        @CreateRow(messageEnd);
<span class='line-number'>879</span>	    }
<span class='line-number'>880</span>	    else
<span class='line-number'>881</span>	    {
<span class='line-number'>882</span>	        message.text.Add(&quot;&lt;strong&gt;&quot; + Translate(&quot;Sign in&quot;) + &quot;:&lt;/strong&gt; &quot; + GetString(&quot;DWExtranetUsername&quot;));
<span class='line-number'>883</span>	        message.text.Add(&quot;&lt;strong&gt;&quot; + Translate(&quot;Password&quot;) + &quot;:&lt;/strong&gt; &quot; + GetString(&quot;DWExtranetPassword&quot;));
<span class='line-number'>884</span>	        @CreateRow(message);
<span class='line-number'>885</span>	    }
<span class='line-number'>886</span>	}
<span class='line-number'>887</span>	                &lt;/td&gt;
<span class='line-number'>888</span>	            &lt;/tr&gt;
<span class='line-number'>889</span>	        &lt;/table&gt;
<span class='line-number'>890</span>	    &lt;/center&gt;
<span class='line-number'>891</span>	&lt;/body&gt;
<span class='line-number'>892</span>	&lt;/html&gt;
<span class='line-number'>893</span>	
<span class='line-number'>894</span>	@helper CreatePreheader(string viewInBrowserLink = &quot;#&quot;)
<span class='line-number'>895</span>	{
<span class='line-number'>896</span>	    &lt;!-- EMAIL HEADER // --&gt;
<span class='line-number'>897</span>	    &lt;!--
<span class='line-number'>898</span>	        The table &quot;emailBody&quot; is the email&#39;s container.
<span class='line-number'>899</span>	        Its width can be set to 100% for a color band
<span class='line-number'>900</span>	        that spans the width of the page.
<span class='line-number'>901</span>	    --&gt;
<span class='line-number'>902</span>	    &lt;table bgcolor=&quot;#d3d3d3&quot; border=&quot;0&quot; cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; width=&quot;500&quot; id=&quot;emailHeader&quot;&gt;
<span class='line-number'>903</span>	
<span class='line-number'>904</span>	        &lt;!-- HEADER ROW // --&gt;
<span class='line-number'>905</span>	        &lt;tr&gt;
<span class='line-number'>906</span>	            &lt;td align=&quot;center&quot; valign=&quot;top&quot;&gt;
<span class='line-number'>907</span>	                &lt;!-- CENTERING TABLE // --&gt;
<span class='line-number'>908</span>	                &lt;table border=&quot;0&quot; cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; width=&quot;100%&quot;&gt;
<span class='line-number'>909</span>	                    &lt;tr&gt;
<span class='line-number'>910</span>	                        &lt;td align=&quot;center&quot; valign=&quot;top&quot;&gt;
<span class='line-number'>911</span>	                            &lt;!-- FLEXIBLE CONTAINER // --&gt;
<span class='line-number'>912</span>	                            &lt;table border=&quot;0&quot; cellpadding=&quot;10&quot; cellspacing=&quot;0&quot; width=&quot;500&quot; class=&quot;flexibleContainer&quot;&gt;
<span class='line-number'>913</span>	                                &lt;tr&gt;
<span class='line-number'>914</span>	                                    &lt;td valign=&quot;top&quot; width=&quot;500&quot; class=&quot;flexibleContainerCell&quot;&gt;
<span class='line-number'>915</span>	
<span class='line-number'>916</span>	                                        &lt;!-- CONTENT TABLE // --&gt;
<span class='line-number'>917</span>	                                        &lt;table align=&quot;left&quot; border=&quot;0&quot; cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; width=&quot;100%&quot;&gt;
<span class='line-number'>918</span>	                                            &lt;tr&gt;
<span class='line-number'>919</span>	                                                &lt;!--
<span class='line-number'>920</span>	                                                    The &quot;invisibleIntroduction&quot; is the text used for short preview
<span class='line-number'>921</span>	                                                    of the email before the user opens it (50 characters max). Sometimes,
<span class='line-number'>922</span>	                                                    you do not want to show this message depending on your design but this
<span class='line-number'>923</span>	                                                    text is highly recommended.
<span class='line-number'>924</span>	
<span class='line-number'>925</span>	                                                    You do not have to worry if it is hidden, the next &lt;td&gt; will automatically
<span class='line-number'>926</span>	                                                    center and apply to the width 100% and also shrink to 50% if the first &lt;td&gt;
<span class='line-number'>927</span>	                                                    is visible.
<span class='line-number'>928</span>	                                                --&gt;
<span class='line-number'>929</span>	                                                &lt;td align=&quot;left&quot; valign=&quot;middle&quot; id=&quot;invisibleIntroduction&quot; class=&quot;flexibleContainerBox&quot; style=&quot;display:none !important; mso-hide:all;&quot;&gt;
<span class='line-number'>930</span>	                                                    &lt;table border=&quot;0&quot; cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; width=&quot;100%&quot; style=&quot;max-width:100%;&quot;&gt;
<span class='line-number'>931</span>	                                                        &lt;tr&gt;
<span class='line-number'>932</span>	                                                            &lt;td align=&quot;left&quot; class=&quot;textContent&quot;&gt;
<span class='line-number'>933</span>	                                                                &lt;div style=&quot;font-family:Helvetica,Arial,sans-serif;font-size:13px;color:#828282;text-align:center;line-height:120%;&quot;&gt;
<span class='line-number'>934</span>	
<span class='line-number'>935</span>	                                                                &lt;/div&gt;
<span class='line-number'>936</span>	                                                            &lt;/td&gt;
<span class='line-number'>937</span>	                                                        &lt;/tr&gt;
<span class='line-number'>938</span>	                                                    &lt;/table&gt;
<span class='line-number'>939</span>	                                                &lt;/td&gt;
<span class='line-number'>940</span>	                                                &lt;td align=&quot;right&quot; valign=&quot;middle&quot; class=&quot;flexibleContainerBox&quot;&gt;
<span class='line-number'>941</span>	                                                    &lt;table border=&quot;0&quot; cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; width=&quot;100%&quot; style=&quot;max-width:100%;&quot;&gt;
<span class='line-number'>942</span>	                                                        &lt;tr&gt;
<span class='line-number'>943</span>	                                                            &lt;td align=&quot;left&quot; class=&quot;textContent&quot;&gt;
<span class='line-number'>944</span>	                                                                &lt;!-- CONTENT // --&gt;
<span class='line-number'>945</span>	                                                                &lt;div style=&quot;font-family:Helvetica,Arial,sans-serif;font-size:13px;color:#828282;text-align:center;line-height:120%;&quot;&gt;
<span class='line-number'>946</span>	                                                                    @Translate(&quot;If you can&#39;t see this message&quot;) &lt;a href=&quot;@viewInBrowserLink&quot; target=&quot;_blank&quot; style=&quot;text-decoration:underline;color:#828282;&quot;&gt;&lt;span style=&quot;color:#828282;&quot;&gt;@Translate(&quot;view it in your browser&quot;)&lt;/span&gt;&lt;/a&gt;.
<span class='line-number'>947</span>	                                                                &lt;/div&gt;
<span class='line-number'>948</span>	                                                            &lt;/td&gt;
<span class='line-number'>949</span>	                                                        &lt;/tr&gt;
<span class='line-number'>950</span>	                                                    &lt;/table&gt;
<span class='line-number'>951</span>	                                                &lt;/td&gt;
<span class='line-number'>952</span>	                                            &lt;/tr&gt;
<span class='line-number'>953</span>	                                        &lt;/table&gt;
<span class='line-number'>954</span>	                                    &lt;/td&gt;
<span class='line-number'>955</span>	                                &lt;/tr&gt;
<span class='line-number'>956</span>	                            &lt;/table&gt;
<span class='line-number'>957</span>	                            &lt;!-- // FLEXIBLE CONTAINER --&gt;
<span class='line-number'>958</span>	                        &lt;/td&gt;
<span class='line-number'>959</span>	                    &lt;/tr&gt;
<span class='line-number'>960</span>	                &lt;/table&gt;
<span class='line-number'>961</span>	                &lt;!-- // CENTERING TABLE --&gt;
<span class='line-number'>962</span>	            &lt;/td&gt;
<span class='line-number'>963</span>	        &lt;/tr&gt;
<span class='line-number'>964</span>	        &lt;!-- // END --&gt;
<span class='line-number'>965</span>	
<span class='line-number'>966</span>	    &lt;/table&gt;
<span class='line-number'>967</span>	    &lt;!-- // END --&gt;
<span class='line-number'>968</span>	}
<span class='line-number'>969</span>	
<span class='line-number'>970</span>	@helper CreateSubscriptionFooter(string subscriptionLink = &quot;#&quot;)
<span class='line-number'>971</span>	{
<span class='line-number'>972</span>	    &lt;!-- EMAIL FOOTER // --&gt;
<span class='line-number'>973</span>	    &lt;!--
<span class='line-number'>974</span>	        The table &quot;emailBody&quot; is the email&#39;s container.
<span class='line-number'>975</span>	        Its width can be set to 100% for a color band
<span class='line-number'>976</span>	        that spans the width of the page.
<span class='line-number'>977</span>	    --&gt;
<span class='line-number'>978</span>	    &lt;table bgcolor=&quot;#d3d3d3&quot; border=&quot;0&quot; cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; width=&quot;500&quot; id=&quot;emailFooter&quot;&gt;
<span class='line-number'>979</span>	
<span class='line-number'>980</span>	        &lt;!-- FOOTER ROW // --&gt;
<span class='line-number'>981</span>	        &lt;!--
<span class='line-number'>982</span>	            To move or duplicate any of the design patterns
<span class='line-number'>983</span>	            in this email, simply move or copy the entire
<span class='line-number'>984</span>	            MODULE ROW section for each content block.
<span class='line-number'>985</span>	        --&gt;
<span class='line-number'>986</span>	        &lt;tr&gt;
<span class='line-number'>987</span>	            &lt;td align=&quot;center&quot; valign=&quot;top&quot;&gt;
<span class='line-number'>988</span>	                &lt;!-- CENTERING TABLE // --&gt;
<span class='line-number'>989</span>	                &lt;table border=&quot;0&quot; cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; width=&quot;100%&quot;&gt;
<span class='line-number'>990</span>	                    &lt;tr&gt;
<span class='line-number'>991</span>	                        &lt;td align=&quot;center&quot; valign=&quot;top&quot;&gt;
<span class='line-number'>992</span>	                            &lt;!-- FLEXIBLE CONTAINER // --&gt;
<span class='line-number'>993</span>	                            &lt;table border=&quot;0&quot; cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; width=&quot;500&quot; class=&quot;flexibleContainer&quot;&gt;
<span class='line-number'>994</span>	                                &lt;tr&gt;
<span class='line-number'>995</span>	                                    &lt;td align=&quot;center&quot; valign=&quot;top&quot; width=&quot;500&quot; class=&quot;flexibleContainerCell&quot;&gt;
<span class='line-number'>996</span>	                                        &lt;table border=&quot;0&quot; cellpadding=&quot;30&quot; cellspacing=&quot;0&quot; width=&quot;100%&quot;&gt;
<span class='line-number'>997</span>	                                            &lt;tr&gt;
<span class='line-number'>998</span>	                                                &lt;td valign=&quot;top&quot; bgcolor=&quot;#d3d3d3&quot;&gt;
<span class='line-number'>999</span>	
<span class='line-number'>1000</span>	                                                    &lt;div style=&quot;font-family:Helvetica,Arial,sans-serif;font-size:13px;color:#828282;text-align:center;line-height:120%;&quot;&gt;
<span class='line-number'>1001</span>	                                                        &lt;div&gt;@Translate(&quot;If you do not want to recieve emails from us, you can&quot;) &lt;a href=&quot;@subscriptionLink&quot; target=&quot;_blank&quot; style=&quot;text-decoration:none;color:#828282;&quot;&gt;&lt;span style=&quot;color:#828282;&quot;&gt;@Translate(&quot;unsubscribe&quot;)&lt;/span&gt;&lt;/a&gt;.&lt;/div&gt;
<span class='line-number'>1002</span>	                                                    &lt;/div&gt;
<span class='line-number'>1003</span>	
<span class='line-number'>1004</span>	                                                &lt;/td&gt;
<span class='line-number'>1005</span>	                                            &lt;/tr&gt;
<span class='line-number'>1006</span>	                                        &lt;/table&gt;
<span class='line-number'>1007</span>	                                    &lt;/td&gt;
<span class='line-number'>1008</span>	                                &lt;/tr&gt;
<span class='line-number'>1009</span>	                            &lt;/table&gt;
<span class='line-number'>1010</span>	                            &lt;!-- // FLEXIBLE CONTAINER --&gt;
<span class='line-number'>1011</span>	                        &lt;/td&gt;
<span class='line-number'>1012</span>	                    &lt;/tr&gt;
<span class='line-number'>1013</span>	                &lt;/table&gt;
<span class='line-number'>1014</span>	                &lt;!-- // CENTERING TABLE --&gt;
<span class='line-number'>1015</span>	            &lt;/td&gt;
<span class='line-number'>1016</span>	        &lt;/tr&gt;
<span class='line-number'>1017</span>	    &lt;/table&gt;
<span class='line-number'>1018</span>		&lt;!-- // END --&gt;
<span class='line-number'>1019</span>	}
<span class='line-number'>1020</span>	
<span class='line-number'>1021</span>	@helper CreateRow(Column columnObjectOne, RowSettings rowSettings = null)
<span class='line-number'>1022</span>	{
<span class='line-number'>1023</span>	    if (rowSettings == null)
<span class='line-number'>1024</span>	    {
<span class='line-number'>1025</span>	        rowSettings = new RowSettings();
<span class='line-number'>1026</span>	    }
<span class='line-number'>1027</span>	
<span class='line-number'>1028</span>	    if (string.IsNullOrEmpty(columnObjectOne.imageSize)) 
<span class='line-number'>1029</span>	    {
<span class='line-number'>1030</span>	        columnObjectOne.imageSize = &quot;500&quot;;
<span class='line-number'>1031</span>	    }
<span class='line-number'>1032</span>	
<span class='line-number'>1033</span>	    if (string.IsNullOrEmpty(columnObjectOne.width)) 
<span class='line-number'>1034</span>	    {
<span class='line-number'>1035</span>	        columnObjectOne.width = &quot;500&quot;;
<span class='line-number'>1036</span>	    }
<span class='line-number'>1037</span>	    
<span class='line-number'>1038</span>	    if (string.IsNullOrEmpty(columnObjectOne.align)) 
<span class='line-number'>1039</span>	    {
<span class='line-number'>1040</span>	        columnObjectOne.align = &quot;center&quot;;
<span class='line-number'>1041</span>	    }
<span class='line-number'>1042</span>	
<span class='line-number'>1043</span>	    @CreateOneColumn(columnObjectOne, rowSettings);
<span class='line-number'>1044</span>	}
<span class='line-number'>1045</span>	
<span class='line-number'>1046</span>	@helper CreateRow(Column columnObjectOne, Column columnObjectTwo, RowSettings rowSettings = null)
<span class='line-number'>1047</span>	{
<span class='line-number'>1048</span>	    if (rowSettings == null)
<span class='line-number'>1049</span>	    {
<span class='line-number'>1050</span>	        rowSettings = new RowSettings();
<span class='line-number'>1051</span>	    }
<span class='line-number'>1052</span>	
<span class='line-number'>1053</span>	    if (string.IsNullOrEmpty(columnObjectOne.imageSize)) 
<span class='line-number'>1054</span>	    {
<span class='line-number'>1055</span>	        columnObjectOne.imageSize = &quot;210&quot;;
<span class='line-number'>1056</span>	    }
<span class='line-number'>1057</span>	
<span class='line-number'>1058</span>	    if (string.IsNullOrEmpty(columnObjectTwo.imageSize)) 
<span class='line-number'>1059</span>	    {
<span class='line-number'>1060</span>	        columnObjectTwo.imageSize = &quot;210&quot;;
<span class='line-number'>1061</span>	    }
<span class='line-number'>1062</span>	
<span class='line-number'>1063</span>	    if (string.IsNullOrEmpty(columnObjectOne.width)) 
<span class='line-number'>1064</span>	    {
<span class='line-number'>1065</span>	        columnObjectOne.width = &quot;210&quot;;
<span class='line-number'>1066</span>	    }
<span class='line-number'>1067</span>	
<span class='line-number'>1068</span>	    if (string.IsNullOrEmpty(columnObjectTwo.width)) 
<span class='line-number'>1069</span>	    {
<span class='line-number'>1070</span>	        columnObjectTwo.width = &quot;210&quot;;
<span class='line-number'>1071</span>	    }
<span class='line-number'>1072</span>	
<span class='line-number'>1073</span>	    @CreateTwoColumns(columnObjectOne, columnObjectTwo, rowSettings);
<span class='line-number'>1074</span>	}
<span class='line-number'>1075</span>	
<span class='line-number'>1076</span>	@helper CreateRow(Column columnObjectOne, Column columnObjectTwo, Column columnObjectThree, RowSettings rowSettings = null)
<span class='line-number'>1077</span>	{
<span class='line-number'>1078</span>	    if (rowSettings == null)
<span class='line-number'>1079</span>	    {
<span class='line-number'>1080</span>	        rowSettings = new RowSettings();
<span class='line-number'>1081</span>	    }
<span class='line-number'>1082</span>	
<span class='line-number'>1083</span>	    if (string.IsNullOrEmpty(columnObjectOne.imageSize)) 
<span class='line-number'>1084</span>	    {
<span class='line-number'>1085</span>	        columnObjectOne.imageSize = &quot;126&quot;;
<span class='line-number'>1086</span>	    }
<span class='line-number'>1087</span>	
<span class='line-number'>1088</span>	    if (string.IsNullOrEmpty(columnObjectTwo.imageSize)) 
<span class='line-number'>1089</span>	    {
<span class='line-number'>1090</span>	        columnObjectTwo.imageSize = &quot;126&quot;;
<span class='line-number'>1091</span>	    }
<span class='line-number'>1092</span>	
<span class='line-number'>1093</span>	    if (string.IsNullOrEmpty(columnObjectThree.imageSize)) 
<span class='line-number'>1094</span>	    {
<span class='line-number'>1095</span>	        columnObjectThree.imageSize = &quot;126&quot;;
<span class='line-number'>1096</span>	    }
<span class='line-number'>1097</span>	
<span class='line-number'>1098</span>	    if (string.IsNullOrEmpty(columnObjectOne.width)) 
<span class='line-number'>1099</span>	    {
<span class='line-number'>1100</span>	        columnObjectOne.width = &quot;126&quot;;
<span class='line-number'>1101</span>	    }
<span class='line-number'>1102</span>	
<span class='line-number'>1103</span>	    if (string.IsNullOrEmpty(columnObjectTwo.width)) 
<span class='line-number'>1104</span>	    {
<span class='line-number'>1105</span>	        columnObjectTwo.width = &quot;126&quot;;
<span class='line-number'>1106</span>	    }
<span class='line-number'>1107</span>	
<span class='line-number'>1108</span>	    if (string.IsNullOrEmpty(columnObjectThree.width)) 
<span class='line-number'>1109</span>	    {
<span class='line-number'>1110</span>	        columnObjectThree.width = &quot;126&quot;;
<span class='line-number'>1111</span>	    }
<span class='line-number'>1112</span>	
<span class='line-number'>1113</span>	    @CreateThreeColumns(columnObjectOne, columnObjectTwo, columnObjectThree, rowSettings);
<span class='line-number'>1114</span>	}
<span class='line-number'>1115</span>	
<span class='line-number'>1116</span>	@helper CreateRowDivider()
<span class='line-number'>1117</span>	{
<span class='line-number'>1118</span>	    &lt;tr&gt;
<span class='line-number'>1119</span>	        &lt;td align=&quot;center&quot; valign=&quot;top&quot;&gt;
<span class='line-number'>1120</span>	            &lt;table border=&quot;0&quot; cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; width=&quot;100%&quot;&gt;
<span class='line-number'>1121</span>	                &lt;tr&gt;
<span class='line-number'>1122</span>	                    &lt;td align=&quot;center&quot; valign=&quot;top&quot;&gt;
<span class='line-number'>1123</span>	                        &lt;table border=&quot;0&quot; cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; width=&quot;500&quot; class=&quot;flexibleContainer&quot;&gt;
<span class='line-number'>1124</span>	                            &lt;tr&gt;
<span class='line-number'>1125</span>	                                &lt;td align=&quot;center&quot; valign=&quot;top&quot; width=&quot;500&quot; class=&quot;flexibleContainerCell&quot;&gt;
<span class='line-number'>1126</span>	                                    &lt;table class=&quot;flexibleContainerCellDivider&quot; border=&quot;0&quot; cellpadding=&quot;30&quot; cellspacing=&quot;0&quot; width=&quot;100%&quot;&gt;
<span class='line-number'>1127</span>	                                        &lt;tr&gt;
<span class='line-number'>1128</span>	                                            &lt;td align=&quot;center&quot; valign=&quot;top&quot; style=&quot;padding-top:0px;padding-bottom:0px;&quot;&gt;
<span class='line-number'>1129</span>	                                                &lt;table border=&quot;0&quot; cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; width=&quot;100%&quot;&gt;
<span class='line-number'>1130</span>	                                                    &lt;tr&gt;
<span class='line-number'>1131</span>	                                                        &lt;td align=&quot;center&quot; valign=&quot;top&quot; style=&quot;border-top:1px solid #a8a8a8;&quot;&gt;&lt;/td&gt;
<span class='line-number'>1132</span>	                                                    &lt;/tr&gt;
<span class='line-number'>1133</span>	                                                &lt;/table&gt;
<span class='line-number'>1134</span>	                                            &lt;/td&gt;
<span class='line-number'>1135</span>	                                        &lt;/tr&gt;
<span class='line-number'>1136</span>	                                    &lt;/table&gt;
<span class='line-number'>1137</span>	                                &lt;/td&gt;
<span class='line-number'>1138</span>	                            &lt;/tr&gt;
<span class='line-number'>1139</span>	                        &lt;/table&gt;
<span class='line-number'>1140</span>	                    &lt;/td&gt;
<span class='line-number'>1141</span>	                &lt;/tr&gt;
<span class='line-number'>1142</span>	            &lt;/table&gt;
<span class='line-number'>1143</span>	        &lt;/td&gt;
<span class='line-number'>1144</span>	    &lt;/tr&gt;
<span class='line-number'>1145</span>	}
<span class='line-number'>1146</span>	
<span class='line-number'>1147</span>	@helper CreateOneColumn(Column columnObject, RowSettings rowSettings)
<span class='line-number'>1148</span>	{
<span class='line-number'>1149</span>	    &lt;tr&gt;
<span class='line-number'>1150</span>	        &lt;td align=&quot;center&quot; valign=&quot;top&quot;&gt;
<span class='line-number'>1151</span>	            &lt;table border=&quot;0&quot; cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; width=&quot;100%&quot; style=&quot;color:@columnObject.textColor; background: @rowSettings.background;&quot; bgcolor=&quot;@rowSettings.backgroundColor&quot;&gt;
<span class='line-number'>1152</span>	                &lt;tr&gt;
<span class='line-number'>1153</span>	                    &lt;td align=&quot;center&quot; valign=&quot;top&quot;&gt;
<span class='line-number'>1154</span>	                        &lt;table border=&quot;0&quot; cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; width=&quot;@columnObject.width&quot; class=&quot;flexibleContainer&quot;&gt;
<span class='line-number'>1155</span>	                            &lt;tr&gt;
<span class='line-number'>1156</span>	                                &lt;td align=&quot;center&quot; valign=&quot;top&quot; width=&quot;500&quot; class=&quot;flexibleContainerCell&quot;&gt;
<span class='line-number'>1157</span>	                                    &lt;table border=&quot;0&quot; cellpadding=&quot;@rowSettings.padding&quot; cellspacing=&quot;0&quot; width=&quot;100%&quot;&gt;
<span class='line-number'>1158</span>	                                        &lt;tr&gt;
<span class='line-number'>1159</span>	                                            &lt;td align=&quot;@columnObject.align&quot; valign=&quot;top&quot; class=&quot;textContent&quot;&gt;
<span class='line-number'>1160</span>	                                                @CreateColumnBlock(columnObject)
<span class='line-number'>1161</span>	                                            &lt;/td&gt;
<span class='line-number'>1162</span>	                                        &lt;/tr&gt;
<span class='line-number'>1163</span>	                                    &lt;/table&gt;
<span class='line-number'>1164</span>	                                &lt;/td&gt;
<span class='line-number'>1165</span>	                            &lt;/tr&gt;
<span class='line-number'>1166</span>	                        &lt;/table&gt;
<span class='line-number'>1167</span>	                    &lt;/td&gt;
<span class='line-number'>1168</span>	                &lt;/tr&gt;
<span class='line-number'>1169</span>	            &lt;/table&gt;
<span class='line-number'>1170</span>	        &lt;/td&gt;
<span class='line-number'>1171</span>	    &lt;/tr&gt;
<span class='line-number'>1172</span>	}
<span class='line-number'>1173</span>	
<span class='line-number'>1174</span>	@helper CreateTwoColumns(Column columnObjectOne, Column columnObjectTwo, RowSettings rowSettings)
<span class='line-number'>1175</span>	{
<span class='line-number'>1176</span>	    &lt;tr mc:hideable=mc:hideable&gt;
<span class='line-number'>1177</span>	        &lt;td align=&quot;center&quot; valign=&quot;top&quot;&gt;
<span class='line-number'>1178</span>	            &lt;table border=&quot;0&quot; cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; width=&quot;100%&quot; style=&quot;color:@columnObjectOne.textColor&quot; bgcolor=&quot;@rowSettings.backgroundColor&quot;&gt;
<span class='line-number'>1179</span>	                &lt;tr&gt;
<span class='line-number'>1180</span>	                    &lt;td align=&quot;center&quot; valign=&quot;top&quot;&gt;
<span class='line-number'>1181</span>	                        &lt;table border=&quot;0&quot; cellpadding=&quot;30&quot; cellspacing=&quot;0&quot; width=&quot;500&quot; class=&quot;flexibleContainer&quot;&gt;
<span class='line-number'>1182</span>	                            &lt;tr&gt;
<span class='line-number'>1183</span>	                                &lt;td valign=&quot;top&quot; width=&quot;500&quot; class=&quot;flexibleContainerCell&quot;&gt;
<span class='line-number'>1184</span>	                                    &lt;table align=&quot;left&quot; border=&quot;0&quot; cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; width=&quot;100%&quot;&gt;
<span class='line-number'>1185</span>	                                        &lt;tr&gt;
<span class='line-number'>1186</span>	                                            &lt;td align=&quot;left&quot; valign=&quot;top&quot; class=&quot;flexibleContainerBox&quot;&gt;
<span class='line-number'>1187</span>	                                                &lt;table border=&quot;0&quot; cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; width=&quot;@columnObjectOne.width&quot; style=&quot;max-width: 100%;&quot;&gt;
<span class='line-number'>1188</span>	                                                    &lt;tr&gt;
<span class='line-number'>1189</span>	                                                        &lt;td align=&quot;left&quot; class=&quot;textContent&quot;&gt;
<span class='line-number'>1190</span>	                                                            @CreateColumnBlock(columnObjectOne)
<span class='line-number'>1191</span>	                                                        &lt;/td&gt;
<span class='line-number'>1192</span>	                                                    &lt;/tr&gt;
<span class='line-number'>1193</span>	                                                &lt;/table&gt;
<span class='line-number'>1194</span>	                                            &lt;/td&gt;
<span class='line-number'>1195</span>	                                            &lt;td align=&quot;right&quot; valign=&quot;top&quot; class=&quot;flexibleContainerBox&quot;&gt;
<span class='line-number'>1196</span>	                                                &lt;table class=&quot;flexibleContainerBoxNext&quot; border=&quot;0&quot; cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; width=&quot;@columnObjectTwo.width&quot; style=&quot;max-width: 100%;&quot;&gt;
<span class='line-number'>1197</span>	                                                    &lt;tr&gt;
<span class='line-number'>1198</span>	                                                        &lt;td align=&quot;left&quot; class=&quot;textContent&quot;&gt;
<span class='line-number'>1199</span>	                                                            @CreateColumnBlock(columnObjectTwo)
<span class='line-number'>1200</span>	                                                        &lt;/td&gt;
<span class='line-number'>1201</span>	                                                    &lt;/tr&gt;
<span class='line-number'>1202</span>	                                                &lt;/table&gt;
<span class='line-number'>1203</span>	                                            &lt;/td&gt;
<span class='line-number'>1204</span>	                                        &lt;/tr&gt;
<span class='line-number'>1205</span>	                                    &lt;/table&gt;
<span class='line-number'>1206</span>	                                &lt;/td&gt;
<span class='line-number'>1207</span>	                            &lt;/tr&gt;
<span class='line-number'>1208</span>	                        &lt;/table&gt;
<span class='line-number'>1209</span>	                    &lt;/td&gt;
<span class='line-number'>1210</span>	                &lt;/tr&gt;
<span class='line-number'>1211</span>	            &lt;/table&gt;
<span class='line-number'>1212</span>	        &lt;/td&gt;
<span class='line-number'>1213</span>	    &lt;/tr&gt;
<span class='line-number'>1214</span>	}
<span class='line-number'>1215</span>	
<span class='line-number'>1216</span>	@helper CreateThreeColumns(Column columnObjectOne, Column columnObjectTwo, Column columnObjectThree, RowSettings rowSettings)
<span class='line-number'>1217</span>	{
<span class='line-number'>1218</span>	    &lt;tr mc:hideable=mc:hideable&gt;
<span class='line-number'>1219</span>	        &lt;td align=&quot;center&quot; valign=&quot;top&quot;&gt;
<span class='line-number'>1220</span>	            &lt;table border=&quot;0&quot; cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; width=&quot;100%&quot; style=&quot;color:@columnObjectOne.textColor&quot; bgcolor=&quot;@rowSettings.backgroundColor&quot;&gt;
<span class='line-number'>1221</span>	                &lt;tr&gt;
<span class='line-number'>1222</span>	                    &lt;td align=&quot;center&quot; valign=&quot;top&quot;&gt;
<span class='line-number'>1223</span>	                        &lt;table border=&quot;0&quot; cellpadding=&quot;30&quot; cellspacing=&quot;0&quot; width=&quot;500&quot; class=&quot;flexibleContainer&quot;&gt;
<span class='line-number'>1224</span>	                            &lt;tr&gt;
<span class='line-number'>1225</span>	                                &lt;td valign=&quot;top&quot; width=&quot;500&quot; class=&quot;flexibleContainerCell&quot;&gt;
<span class='line-number'>1226</span>	                                    &lt;table align=&quot;left&quot; border=&quot;0&quot; cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; width=&quot;100%&quot;&gt;
<span class='line-number'>1227</span>	                                        &lt;tr&gt;
<span class='line-number'>1228</span>	                                            &lt;td align=&quot;left&quot; valign=&quot;top&quot; class=&quot;flexibleContainerBox&quot;&gt;
<span class='line-number'>1229</span>	                                                &lt;table border=&quot;0&quot; cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; width=&quot;@columnObjectOne.width&quot; style=&quot;max-width: 100%;&quot;&gt;
<span class='line-number'>1230</span>	                                                    &lt;tr&gt;
<span class='line-number'>1231</span>	                                                        &lt;td align=&quot;left&quot; class=&quot;textContent&quot;&gt;
<span class='line-number'>1232</span>	                                                            @CreateColumnBlock(columnObjectOne)
<span class='line-number'>1233</span>	                                                        &lt;/td&gt;
<span class='line-number'>1234</span>	                                                    &lt;/tr&gt;
<span class='line-number'>1235</span>	                                                &lt;/table&gt;
<span class='line-number'>1236</span>	                                            &lt;/td&gt;
<span class='line-number'>1237</span>	                                            &lt;td align=&quot;center&quot; valign=&quot;top&quot; class=&quot;flexibleContainerBox&quot;&gt;
<span class='line-number'>1238</span>	                                                &lt;table class=&quot;flexibleContainerBoxNext&quot; border=&quot;0&quot; cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; width=&quot;@columnObjectTwo.width&quot; style=&quot;max-width: 100%;&quot;&gt;
<span class='line-number'>1239</span>	                                                    &lt;tr&gt;
<span class='line-number'>1240</span>	                                                        &lt;td align=&quot;left&quot; class=&quot;textContent&quot;&gt;
<span class='line-number'>1241</span>	                                                            @CreateColumnBlock(columnObjectTwo)
<span class='line-number'>1242</span>	                                                        &lt;/td&gt;
<span class='line-number'>1243</span>	                                                    &lt;/tr&gt;
<span class='line-number'>1244</span>	                                                &lt;/table&gt;
<span class='line-number'>1245</span>	                                            &lt;/td&gt;
<span class='line-number'>1246</span>	                                            &lt;td align=&quot;right&quot; valign=&quot;top&quot; class=&quot;flexibleContainerBox&quot;&gt;
<span class='line-number'>1247</span>	                                                &lt;table class=&quot;flexibleContainerBoxNext&quot; border=&quot;0&quot; cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; width=&quot;@columnObjectThree.width&quot; style=&quot;max-width: 100%;&quot;&gt;
<span class='line-number'>1248</span>	                                                    &lt;tr&gt;
<span class='line-number'>1249</span>	                                                        &lt;td align=&quot;left&quot; class=&quot;textContent&quot;&gt;
<span class='line-number'>1250</span>	                                                            @CreateColumnBlock(columnObjectThree)
<span class='line-number'>1251</span>	                                                        &lt;/td&gt;
<span class='line-number'>1252</span>	                                                    &lt;/tr&gt;
<span class='line-number'>1253</span>	                                                &lt;/table&gt;
<span class='line-number'>1254</span>	                                            &lt;/td&gt;
<span class='line-number'>1255</span>	                                        &lt;/tr&gt;
<span class='line-number'>1256</span>	                                    &lt;/table&gt;
<span class='line-number'>1257</span>	                                &lt;/td&gt;
<span class='line-number'>1258</span>	                            &lt;/tr&gt;
<span class='line-number'>1259</span>	                        &lt;/table&gt;
<span class='line-number'>1260</span>	                    &lt;/td&gt;
<span class='line-number'>1261</span>	                &lt;/tr&gt;
<span class='line-number'>1262</span>	            &lt;/table&gt;
<span class='line-number'>1263</span>	        &lt;/td&gt;
<span class='line-number'>1264</span>	    &lt;/tr&gt;
<span class='line-number'>1265</span>	}
<span class='line-number'>1266</span>	
<span class='line-number'>1267</span>	@helper CreateColumnBlock(Column columnObject)
<span class='line-number'>1268</span>	{
<span class='line-number'>1269</span>	    if (!String.IsNullOrEmpty(columnObject.link) &amp;&amp; String.IsNullOrEmpty(columnObject.linkText))
<span class='line-number'>1270</span>	    {
<span class='line-number'>1271</span>	            &lt;a href=&quot;@columnObject.link&quot;&gt;
<span class='line-number'>1272</span>	                @CreateColumnBlockContent(columnObject)
<span class='line-number'>1273</span>	            &lt;/a&gt;
<span class='line-number'>1274</span>	    }
<span class='line-number'>1275</span>	    else
<span class='line-number'>1276</span>	    {
<span class='line-number'>1277</span>	            @CreateColumnBlockContent(columnObject)
<span class='line-number'>1278</span>	    }
<span class='line-number'>1279</span>	}
<span class='line-number'>1280</span>	
<span class='line-number'>1281</span>	@helper CreateColumnBlockContent(Column columnObject)
<span class='line-number'>1282</span>	{
<span class='line-number'>1283</span>	    if (!String.IsNullOrEmpty(columnObject.preheader))
<span class='line-number'>1284</span>	    {
<span class='line-number'>1285</span>	            &lt;small style=&quot;color:@columnObject.textColor;text-align:@columnObject.align;line-height:125%;font-family:Helvetica,Arial,sans-serif;font-size:10px;font-weight:normal;margin-top:0;margin-bottom:3px;&quot;&gt;@columnObject.preheader&lt;/small&gt;
<span class='line-number'>1286</span>	    }
<span class='line-number'>1287</span>	
<span class='line-number'>1288</span>	    if (!String.IsNullOrEmpty(columnObject.image))
<span class='line-number'>1289</span>	    {
<span class='line-number'>1290</span>	            string image = &quot;http://&quot; + GetGlobalValue(&quot;Global:Request.Host&quot;) + &quot;/Admin/Public/GetImage.ashx?width=&quot; + columnObject.imageSize + &quot;&amp;crop=1&amp;image=&quot; + columnObject.image;
<span class='line-number'>1291</span>	            &lt;img src=&quot;@image&quot; width=&quot;@columnObject.imageSize&quot; class=&quot;flexibleImage&quot; style=&quot;max-width:100%;&quot; /&gt;
<span class='line-number'>1292</span>	    }
<span class='line-number'>1293</span>	
<span class='line-number'>1294</span>	    if (!String.IsNullOrEmpty(columnObject.introheader))
<span class='line-number'>1295</span>	    {
<span class='line-number'>1296</span>	            &lt;h1 style=&quot;color:@columnObject.textColor;text-align:@columnObject.align;line-height:100%;font-family:Helvetica,Arial,sans-serif;font-size:35px;font-weight:normal;margin-bottom:5px;&quot;&gt;@columnObject.introheader&lt;/h1&gt;
<span class='line-number'>1297</span>	    }
<span class='line-number'>1298</span>	
<span class='line-number'>1299</span>	    if (!String.IsNullOrEmpty(columnObject.header))
<span class='line-number'>1300</span>	    {
<span class='line-number'>1301</span>	            &lt;h2 style=&quot;color:@columnObject.textColor;text-align:@columnObject.align;font-weight:normal;font-family:Helvetica,Arial,sans-serif;font-size:23px;margin-bottom:10px;line-height:135%;&quot;&gt;@columnObject.header&lt;/h2&gt;
<span class='line-number'>1302</span>	    }
<span class='line-number'>1303</span>	
<span class='line-number'>1304</span>	    if (!String.IsNullOrEmpty(columnObject.subheader))
<span class='line-number'>1305</span>	    {
<span class='line-number'>1306</span>	            &lt;h3 style=&quot;color:@columnObject.textColor;text-align:@columnObject.align;line-height:125%;font-family:Helvetica,Arial,sans-serif;font-size:20px;font-weight:normal;margin-top:0;margin-bottom:3px;&quot;&gt;@columnObject.subheader&lt;/h3&gt;
<span class='line-number'>1307</span>	    }
<span class='line-number'>1308</span>	
<span class='line-number'>1309</span>	    if (!String.IsNullOrEmpty(columnObject.text.content))
<span class='line-number'>1310</span>	    {
<span class='line-number'>1311</span>	            &lt;div style=&quot;color:@columnObject.textColor;text-align:@columnObject.align;font-family:Helvetica,Arial,sans-serif;font-size:15px;margin-bottom:0;line-height:135%;&quot;&gt;@columnObject.text.content&lt;/div&gt;
<span class='line-number'>1312</span>	    }
<span class='line-number'>1313</span>	
<span class='line-number'>1314</span>	    if (!String.IsNullOrEmpty(columnObject.link) &amp;&amp; !String.IsNullOrEmpty(columnObject.linkText))
<span class='line-number'>1315</span>	    {
<span class='line-number'>1316</span>	        string btnColor = !String.IsNullOrEmpty(columnObject.buttonColor) ? columnObject.buttonColor : &quot;#EC683B&quot;;
<span class='line-number'>1317</span>	
<span class='line-number'>1318</span>	            &lt;table border=&quot;0&quot; cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; width=&quot;50%&quot; class=&quot;emailButton&quot; style=&quot;background-color: @btnColor&quot;&gt;
<span class='line-number'>1319</span>	                &lt;tr&gt;
<span class='line-number'>1320</span>	                    &lt;td align=&quot;center&quot; valign=&quot;middle&quot; class=&quot;buttonContent&quot; style=&quot;padding-top:15px;padding-bottom:15px;padding-right:15px;padding-left:15px;&quot;&gt;
<span class='line-number'>1321</span>	                        &lt;a style=&quot;color:#FFFFFF;text-decoration:none;font-family:Helvetica,Arial,sans-serif;font-size:20px;line-height:135%;&quot; href=&quot;@columnObject.link&quot; target=&quot;_blank&quot;&gt;@columnObject.linkText&lt;/a&gt;
<span class='line-number'>1322</span>	                    &lt;/td&gt;
<span class='line-number'>1323</span>	                &lt;/tr&gt;
<span class='line-number'>1324</span>	            &lt;/table&gt;
<span class='line-number'>1325</span>	    }
<span class='line-number'>1326</span>	}
</div>

